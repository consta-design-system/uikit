import { MdxMenu, MdxTabs } from '@consta/stand';
import {
  ProgressStepBarExampleDirectionHorizontal,
  ProgressStepBarExampleDirectionVertical,
} from './examples/ProgressStepBarExampleDirection/ProgressStepBarExampleDirection';
import { ProgressStepBarExampleSize } from './examples/ProgressStepBarExampleSize/ProgressStepBarExampleSize';
import { ProgressStepBarExampleTooltip } from './examples/ProgressStepBarExampleTooltip/ProgressStepBarExampleTooltip';
import { ProgressStepBarExampleProgress } from './examples/ProgressStepBarExampleProgress/ProgressStepBarExampleProgress';
import { ProgressStepBarExampleContent } from './examples/ProgressStepBarExampleContent/ProgressStepBarExampleContent';
import { ProgressStepBarExampleActive } from './examples/ProgressStepBarExampleActive/ProgressStepBarExampleActive';
import { ProgressStepBarExampleAdaptive } from './examples/ProgressStepBarExampleAdaptive/ProgressStepBarExampleAdaptive';

<MdxMenu>

- [Обзор](#обзор)
- [Импорт](#импорт)
- [Свойства](#свойства)
- [Содержимое](#содержимое)
  - [Шаги](#шаги)
  - [Подсказка в тултипе](#подсказка-в-тултипе)
  - [Индикатор шага в процессе](#индикатор-шага)
  - [Дополнительный контент и клик](#дополнительный-контент-и-клик)
- [Внешний вид](#внешний-вид)
  - [Расположение](#расположение)
  - [Размер](#размер)
- [Поведение](#поведение)
  - [Активный шаг](#активный-шаг)
  - [Адаптивность](#адаптивность)
- [Пример использования](#пример-использования)

</MdxMenu>

## Обзор

Компонент `ProgressStepBar` отображает последовательность шагов с возможностью указания их статуса, прогресса и дополнительного контента. Подходит для отображения процессов, таких как прогресс выполнения задачи, навигация по этапам или визуализация рабочих процессов.

## Импорт

```tsx
import { ProgressStepBar } from '@consta/uikit/ProgressStepBar';
```

## Свойства

| Свойство                            | Тип или варианты значения                        | По умолчанию                    | Описание                                            |
| ----------------------------------- | ------------------------------------------------ | ------------------------------- | --------------------------------------------------- |
| [`steps`](#шаги)                    | `ITEM[]`                                         | -                               | Список шагов                                        |
| [`direction?`](#расположение)       | `'horizontal'` &#124; `'vertical'`               | `'horizontal'`                  | Ориентация шагов                                    |
| [`size?`](#размер)                  | `'xs'` &#124; `'s'` &#124; `'m'`                 | `'s'`                           | Размер компонента                                   |
| [`activeStepIndex?`](#активный-шаг) | `string` &#124; `number`                         | -                               | Номер активного шага (нумерация начинается с `0`)   |
| `onItemClick?`                      | `ProgressStepBarPropOnItemClick`                 | -                               | Обработчик клика по шагу                            |
| `getItemLabel?`                     | `ProgressStepBarPropGetItemLabel<ITEM>`          | `(item) => item.label`          | Функция для получения названия шага                 |
| `getItemLineStatus?`                | `ProgressStepBarPropGetItemLineStatus<ITEM>`     | `(item) => item.lineStatus`     | Функция для получения статуса линии                 |
| `getItemTooltipContent?`            | `ProgressStepBarPropGetItemTooltipContent<ITEM>` | `(item) => item.tooltipContent` | Функция для получения содержимого тултипа           |
| `getItemPoint?`                     | `ProgressStepBarPropGetItemPoint<ITEM>`          | `(item) => item.point`          | Функция для получения внутреннего контента шага     |
| `getItemProgress?`                  | `ProgressStepBarPropGetItemProgress<ITEM>`       | `(item) => item.progress`       | Функция для определения прогресса шага              |
| `getItemContent?`                   | `ProgressStepBarPropGetItemContent<ITEM>`        | `(item) => item.content`        | Функция для получения дополнительного контента шага |
| `getItemStatus?`                    | `ProgressStepBarPropGetItemStatus<ITEM>`         | `(item) => item.status`         | Функция для получения статуса шага                  |
| `getItemClick?`                     | `ProgressStepBarPropGetItemOnClick<ITEM>`        | `(item) => item.onClick`        | Функция для обработки клика по шагу                 |
| `className?`                        | `string`                                         | -                               | Дополнительный CSS-класс                            |
| `ref?`                              | `React.Ref<HTMLDivElement>`                      | -                               | Ссылка на корневой элемент                          |

```tsx
export type ProgressStepBarItemDefault = {
  label: string;
  tooltipContent?: string;
  lineStatus?: ProgressStepBarPropStatus;
  point?: ProgressStepBarPointNumbersMap | IconComponent;
  status?: ProgressStepBarPropStatus;
  progress?: boolean;
  content?: React.ReactNode;
  onClick?: React.EventHandler<React.MouseEvent>;
};

type ProgressStepBarPropStatus = 'normal' | 'success' | 'warning' | 'alert';
type ProgressStepBarPointNumbersMap = 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9;
type ProgressStepBarPropGetItemLabel<ITEM> = (item: ITEM) => string;
type ProgressStepBarPropGetItemKey<ITEM> = (item: ITEM) => string | number;
type ProgressStepBarPropGetItemTooltipContent<ITEM> = (
  item: ITEM,
) => string | undefined;
type ProgressStepBarPropGetItemLineStatus<ITEM> = (
  item: ITEM,
) => PropStatus | undefined;
type ProgressStepBarPropGetItemPoint<ITEM> = (
  item: ITEM,
) => PointNumbersMap | IconComponent | undefined;
type ProgressStepBarPropGetItemProgress<ITEM> = (
  item: ITEM,
) => boolean | undefined;
type ProgressStepBarPropGetItemContent<ITEM> = (
  item: ITEM,
) => React.ReactNode | undefined;
type ProgressStepBarPropGetItemStatus<ITEM> = (
  item: ITEM,
) => PropStatus | undefined;
type ProgressStepBarPropGetItemOnClick<ITEM> = (
  item: ITEM,
) => React.EventHandler<React.MouseEvent> | undefined;

type PropOnItemClick<ITEM> = (
  item: ITEM,
  props: {
    e: React.MouseEvent;
    index: number;
  },
) => void;
```

## Содержимое

### Шаги

Список шагов задаётся через свойство `steps` в виде массива объектов. Каждый объект в массиве описывает шаг и может содержать следующие поля:

### Шаги

Список шагов задаётся через свойство `steps` в виде массива объектов. Каждый объект в массиве описывает шаг и может содержать следующие поля:

| Свойство          | Тип или варианты значения                                         | Описание                                                                                                |
| ----------------- | ----------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------- |
| `label`           | `string`                                                          | Название шага, отображается рядом с его обозначением                                                    |
| `tooltipContent?` | `string`                                                          | Текст для всплывающей подсказки ([Tooltip](##LIBS.LIB.STAND/lib:uikit/stand:components-tooltip-stable)) |
| `lineStatus?`     | `'normal' \| 'success' \| 'alert' \| 'warning'`                   | Цвет линии, соединяющей шаги                                                                            |
| `point?`          | `0 \| 1 \| 2 \| 3 \| 4 \| 5 \| 6 \| 7 \| 8 \| 9 \| IconComponent` | Номер шага или иконка, отображаемая в качестве обозначения шага                                         |
| `progress?`       | `boolean`                                                         | Показывает, что шаг в процессе выполнения (отображается индикатор загрузки)                             |
| `content?`        | `React.ReactNode`                                                 | Дополнительное содержимое шага (например, текст, иконки, компоненты)                                    |
| `status?`         | `'normal' \| 'success' \| 'alert' \| 'warning'`                   | Статус шага, влияет на его визуальное отображение                                                       |
| `onClick?`        | `React.EventHandler<React.MouseEvent>`                            | Обработчик клика по шагу                                                                                |

Шаги отображаются в порядке, указанном в массиве.

### Подсказка в тултипе

Для отображения всплывающей подсказки используйте свойство `tooltipContent` в объекте шага. Подсказка появляется при наведении на шаг и содержит краткое описание.

<MdxTabs>

<ProgressStepBarExampleTooltip />

```tsx
type Item = {
  label: string;
  tooltipContent?: string;
  point?: number;
  progress?: boolean;
  status?: 'normal' | 'success' | 'alert' | 'warning';
  lineStatus?: 'normal' | 'success' | 'alert' | 'warning';
};

const steps = [
  {
    label: 'Первый шаг',
    point: 1,
    status: 'normal',
    lineStatus: 'normal',
    tooltipContent: 'Небольшое описание выполнения или состояния на шаге 1',
  },
  {
    label: 'Второй шаг',
    point: 2,
    status: 'warning',
    progress: true,
    lineStatus: 'warning',
    tooltipContent: 'Небольшое описание выполнения или состояния на шаге 2',
  },
  {
    label: 'Третий шаг',
    point: 3,
    status: 'alert',
    progress: true,
    lineStatus: 'alert',
    tooltipContent: 'Небольшое описание выполнения или состояния на шаге 3',
  },
  {
    label: 'Четвёртый шаг',
    point: 4,
    status: 'success',
    tooltipContent: 'Небольшое описание выполнения или состояния на шаге 4',
  },
];

export const ProgressStepBarExampleProgress = () => {
  return <ProgressStepBar steps={steps} activeStepIndex={3} />;
};
```

</MdxTabs>

### Индикатор шага

Свойство `progress` в объекте шага показывает, что шаг находится в процессе выполнения. В таком случае вместо номера или иконки отображается индикатор загрузки.

<MdxTabs>

<ProgressStepBarExampleProgress />

```tsx
type Item = {
  label: string;
  point?: number;
  progress?: boolean;
  status?: 'normal' | 'success' | 'alert' | 'warning';
  lineStatus?: 'normal' | 'success' | 'alert' | 'warning';
};

const steps = [
  {
    label: 'Первый шаг',
    point: 1,
    status: 'normal',
    lineStatus: 'normal',
  },
  {
    label: 'Второй шаг',
    point: 2,
    status: 'normal',
    lineStatus: 'normal',
  },
  {
    label: 'Третий шаг',
    point: 3,
    progress: true,
    status: 'normal',
    lineStatus: 'normal',
  },
  {
    label: 'Четвёртый шаг',
    point: 4,
    status: 'normal',
  },
];

export const ProgressStepBarExampleProgress = () => {
  return <ProgressStepBar steps={steps} activeStepIndex={3} />;
};
```

</MdxTabs>

### Дополнительный контент и клик

Свойство `content` позволяет добавить к шагу дополнительное содержимое, например, иконки, теги или другие компоненты. Свойство `onClick` задаёт действие при клике на шаг.

<MdxTabs>

<ProgressStepBarExampleContent />

```tsx
import React, { useState } from 'react';

import { IconDinosaur } from '@consta/uikit/icons/IconDinosaur';
import { IconSettings } from '@consta/uikit/icons/IconSettings';
import { Tag } from '@consta/uikit/Tag';
import { ProgressStepBar } from '@consta/uikit/ProgressStepBar';

const StepContent = () => {
  return (
    <div>
      <IconDinosaur size="xs" view="secondary" />
      <Tag mode="button" onClick={() => console.log()} label="Черновик" />
      <Tag
        mode="button"
        onClick={() => console.log()}
        label=""
        icon={IconSettings}
      />
    </div>
  );
};

export const ProgressStepBarExampleContent = () => {
  const [status, setStatus] = useState<string>('normal');

  const clickAction = () => {
    setStatus(status === 'normal' ? 'success' : 'normal');
  };

  const steps = [
    {
      label: 'Первый шаг',
      point: 1,
      status,
      lineStatus: 'normal',
      content: <StepContent />,
      onClick: () => clickAction(),
    },
    {
      label: 'Второй шаг',
      point: 2,
      status,
      lineStatus: 'normal',
      onClick: () => clickAction(),
    },
    {
      label: 'Третий шаг',
      point: 3,
      status,
      lineStatus: 'normal',
      onClick: () => clickAction(),
    },
    {
      label: 'Четвёртый шаг',
      point: 4,
      status,
      content: <StepContent />,
      onClick: () => clickAction(),
    },
  ];

  return <ProgressStepBar steps={steps} activeStepIndex={2} size="m" />;
};
```

</MdxTabs>

## Внешний вид

### Расположение

Свойство `direction` определяет ориентацию шагов:

- `'horizontal'` — шаги располагаются горизонтально (по умолчанию).
- `'vertical'` — шаги располагаются вертикально, друг под другом.

```tsx
<ProgressStepBar direction="horizontal" steps={steps} />
```

<ProgressStepBarExampleDirectionHorizontal />

```tsx
<ProgressStepBar direction="vertical" steps={steps} />
```

<ProgressStepBarExampleDirectionVertical />

### Размер

Свойство `size` задаёт размер компонента. Доступные значения: `'xs'`, `'s'`, `'m'`. По умолчанию — `'s'`.

```tsx
<ProgressStepBar size="xs" steps={steps} activeStepIndex={2} />
<ProgressStepBar size="s" steps={steps} activeStepIndex={2} />
<ProgressStepBar size="m" steps={steps} activeStepIndex={2} />
```

<ProgressStepBarExampleSize />

## Поведение

### Активный шаг

Свойство `activeStepIndex` указывает номер активного шага (нумерация начинается с `0`). Активный шаг выделяется визуально.

```tsx
<ProgressStepBar steps={steps} activeStepIndex={0} />
<ProgressStepBar steps={steps} activeStepIndex={1} />
<ProgressStepBar steps={steps} activeStepIndex={2} />
<ProgressStepBar steps={steps} activeStepIndex={3} />
```

<ProgressStepBarExampleActive />

### Адаптивность

На компактных экранах компонент занимает всю доступную ширину. Если шаги не помещаются, появляется горизонтальная прокрутка, которую можно выполнять кнопками или свайпами (на мобильных устройствах). Названия и обозначения шагов сохраняются. Для лучшего отображения на узких экранах рекомендуется использовать `direction="vertical"`.

```tsx
return <ProgressStepBar steps={steps} />;
```

<ProgressStepBarExampleAdaptive />
