import { MdxMenu, MdxTabs } from '@consta/stand';

import { SelectExampleItems } from './examples/SelectExampleItems/SelectExampleItems';
import { SelectExamplePlaceholder } from './examples/SelectExamplePlaceholder/SelectExamplePlaceholder';
import { SelectExampleDisabledItem } from './examples/SelectExampleDisabledItem/SelectExampleDisabledItem';
import { SelectExampleMultiple } from './examples/SelectExampleMultiple/SelectExampleMultiple';
import { SelectExampleGroups } from './examples/SelectExampleGroups/SelectExampleGroups';
import { SelectExampleClearButton } from './examples/SelectExampleClearButton/SelectExampleClearButton';
import { SelectExampleStatus } from './examples/SelectExampleStatus/SelectExampleStatus';
import { SelectExampleSize } from './examples/SelectExampleSize/SelectExampleSize';
import { SelectExampleView } from './examples/SelectExampleView/SelectExampleView';
import { SelectExampleDisabled } from './examples/SelectExampleDisabled/SelectExampleDisabled';
import { SelectExampleCreate } from './examples/SelectExampleCreate/SelectExampleCreate';
import { SelectExampleSelectAll } from './examples/SelectExampleSelectAll/SelectExampleSelectAll';
import { SelectExampleVirtualScroll } from './examples/SelectExampleVirtualScroll/SelectExampleVirtualScroll';
import { SelectExampleDropdownOpen } from './examples/SelectExampleDropdownOpen/SelectExampleDropdownOpen';
import { SelectExampleOpenByFocus } from './examples/SelectExampleOpenByFocus/SelectExampleOpenByFocus';
import { SelectExampleRenderItem } from './examples/SelectExampleRenderItem/SelectExampleRenderItem';
import { SelectExampleRenderValue } from './examples/SelectExampleRenderValue/SelectExampleRenderValue';
import {
  SelectExampleSearch,
  SelectExampleUseSearch,
} from './examples/SelectExampleSearch/SelectExampleSearch';
import {
  SelectExampleIsLoading,
  SelectExampleIsLoadingOnScrollBottom,
} from './examples/SelectExampleIsLoading/SelectExampleIsLoading';

<MdxMenu>

- [Обзор](#обзор)
- [Импорт](#импорт)
- [Свойства](#свойства)
- [Содержимое](#содержимое)
  - [Варианты](#варианты)
  - [Выбранное значение](#выбранное-значение)
  - [Подсказка](#подсказка)
  - [Неактивный элемент списка](#неактивный-элемент-списка)
  - [Множественный выбор](#множественный-выбор)
  - [Группы вариантов](#группы-вариантов)
  - [Кнопка очистки поля](#кнопка-очистки-поля)
- [Внешний вид](#внешний-вид)
  - [Размер](#размер)
  - [Стиль](#стиль)
  - [Форма](#форма)
  - [Статус](#статус)
- [Поведение](#поведение)
  - [Неактивный компонент](#неактивный-компонент)
  - [Поиск](#поиск)
  - [Создание новых вариантов](#создание-новых-вариантов)
  - [Виртуализация списка](#виртуализация-списка)
  - [Индикация загрузки](#индикация-загрузки)
  - [Выбор всех элементов](#выбор-всех-элементов)
  - [Управление состоянием выпадающего списка](#управление-состоянием-выпадающего-списка)
- [Кастомизация](#кастомизация)
  - [Кастомный элемент списка](#кастомный-элемент-списка)
  - [Кастомное выбранное значение](#кастомное-выбранное-значение)
  - [Кастомные типы данных](#кастомные-типы-данных)

</MdxMenu>

## Обзор

Компонент `Select` предоставляет выпадающий список для выбора одного или нескольких вариантов. Поддерживает кастомизацию, группировку, поиск, виртуализацию и другие функции.

## Импорт

```tsx
import { Select } from '@consta/uikit/SelectCanary';
```

## Свойства

| Свойство                                                               | Тип или варианты значения                              | По умолчанию              | Описание                                         |
| ---------------------------------------------------------------------- | ------------------------------------------------------ | ------------------------- | ------------------------------------------------ |
| [`items`](#варианты)                                                   | `ITEM[]`                                               | -                         | Массив элементов списка                          |
| [`value`](#выбранное-значение)                                         | `SelectPropValue<ITEM, MULTIPLE>`                      | -                         | Выбранное значение или массив значений           |
| [`onChange`](#выбранное-значение)                                      | `SelectPropOnChange<ITEM, MULTIPLE>`                   | -                         | Обработчик изменения значения                    |
| [`placeholder`](#подсказка)                                            | `string`                                               | -                         | Подсказка, отображается, когда вариант не выбран |
| [`groups`](#группы-вариантов)                                          | `GROUP[]`                                              | -                         | Массив групп для элементов списка                |
| [`multiple`](#множественный-выбор)                                     | `boolean`                                              | `false`                   | Включение множественного выбора                  |
| [`clearButton`](#кнопка-очистки-поля)                                  | `boolean`                                              | -                         | Показывает кнопку очистки поля                   |
| [`size`](#размер)                                                      | `'xs' \| 's' \| 'm' \| 'l'`                            | `'m'`                     | Размер компонента                                |
| [`view`](#стиль)                                                       | `'default' \| 'clear'`                                 | `'default'`               | Внешний вид компонента                           |
| [`form`](#форма)                                                       | `FieldPropForm`                                        | `'default'`               | Форма компонента                                 |
| [`status`](#статус)                                                    | `'' \| 'alert' \| 'success' \| 'warning'`              | `''`                      | Статус поля для выделения состояния              |
| [`disabled`](#неактивный-компонент)                                    | `boolean`                                              | -                         | Делает компонент неактивным                      |
| [`input`](#поиск)                                                      | `boolean`                                              | -                         | Включение текстового поля для поиска             |
| [`onInput`](#поиск)                                                    | `(value: string) => void`                              | -                         | Обработчик изменения значения в поле поиска      |
| [`labelForEmptyItems`](#поиск)                                         | `string`                                               | `'Список пуст'`           | Текст при отсутствии элементов в списке          |
| [`isLoading`](#индикация-загрузки)                                     | `boolean`                                              | -                         | Показывает индикатор загрузки                    |
| [`onCreate`](#создание-новых-вариантов)                                | `SelectPropOnCreate`                                   | -                         | Обработчик создания нового элемента              |
| [`labelForCreate`](#создание-новых-вариантов)                          | `string`                                               | `'+'`                     | Текст кнопки создания нового элемента            |
| [`virtualScroll`](#виртуализация-списка)                               | `boolean`                                              | -                         | Включает виртуализацию скролла                   |
| [`selectAll`](#выбор-всех-элементов)                                   | `boolean`                                              | `false`                   | Добавляет возможность выбора всех элементов      |
| [`allSelectedAllLabel`](#выбор-всех-элементов)                         | `string`                                               | -                         | Текст для выбора всех элементов                  |
| [`dropdownOpen`](#управление-состоянием-выпадающего-списка)            | `boolean`                                              | -                         | Состояние выпадающего списка (открыт/закрыт)     |
| [`onDropdownOpen`](#управление-состоянием-выпадающего-списка)          | `(open: boolean) => void`                              | -                         | Обработчик открытия/закрытия списка              |
| [`ignoreOutsideClicksRefs`](#управление-состоянием-выпадающего-списка) | `ReadonlyArray<React.RefObject<HTMLElement>>`          | -                         | Игнорируемые элементы при клике вне компонента   |
| [`renderItem`](#кастомный-элемент-списка)                              | `SelectPropRenderItem<ITEM>`                           | -                         | Функция рендера элемента списка                  |
| [`renderValue`](#кастомное-выбранное-значение)                         | `SelectPropRenderValue<ITEM, MULTIPLE>`                | -                         | Функция рендера выбранного значения              |
| [`getItemLabel`](#кастомные-типы-данных)                               | `SelectPropGetItemLabel<ITEM>`                         | `(item) => item.label`    | Функция получения названия элемента              |
| [`getItemKey`](#кастомные-типы-данных)                                 | `SelectPropGetItemKey<ITEM>`                           | `(item) => item.id`       | Функция получения ключа элемента                 |
| [`getItemGroupKey`](#кастомные-типы-данных)                            | `SelectPropGetItemGroupKey<ITEM>`                      | `(item) => item.groupId`  | Функция получения ключа группы элемента          |
| [`getItemDisabled`](#кастомные-типы-данных)                            | `SelectPropGetItemDisabled<ITEM>`                      | `(item) => item.disabled` | Функция определения состояния `disabled`         |
| [`getGroupLabel`](#кастомные-типы-данных)                              | `SelectPropGetGroupLabel<GROUP>`                       | `(group) => group.label`  | Функция получения названия группы                |
| [`getGroupKey`](#кастомные-типы-данных)                                | `SelectPropGetGroupKey<GROUP>`                         | `(group) => group.id`     | Функция получения ключа группы                   |
| `dropdownClassName`                                                    | `string`                                               | -                         | CSS-класс для выпадающего списка                 |
| `dropdownRef`                                                          | `React.Ref<HTMLDivElement>`                            | -                         | Ссылка на элемент выпадающего списка             |
| `inputRef`                                                             | `React.Ref<HTMLInputElement>`                          | -                         | Ссылка на поле ввода                             |
| `inputValue`                                                           | `string`                                               | -                         | Значение поля ввода                              |
| `inputDefaultValue`                                                    | `string`                                               | -                         | Начальное значение поля ввода                    |
| `onFocus`                                                              | `(event?: React.FocusEvent<HTMLInputElement>) => void` | -                         | Обработчик события фокуса                        |
| `onBlur`                                                               | `(event?: React.FocusEvent<HTMLInputElement>) => void` | -                         | Обработчик события потери фокуса                 |
| `onScrollToBottom`                                                     | `(length: number) => void`                             | -                         | Обработчик прокрутки до конца списка             |
| `iconClear`                                                            | `IconComponent`                                        | -                         | Иконка кнопки очистки                            |
| `aria-label`                                                           | `string`                                               | -                         | Атрибут `aria-label` для поля ввода              |
| `className`                                                            | `string`                                               | -                         | Дополнительный CSS-класс                         |
| `ref`                                                                  | `React.Ref<HTMLDivElement>`                            | -                         | Ссылка на корневой DOM-элемент компонента        |

## Содержимое

### Варианты

Свойство `items` задаёт массив элементов выпадающего списка. Тип по умолчанию — `SelectItemDefault`:

- `label: string` — название элемента (пишите с заглавной буквы, без точки).
- `id: string | number` — уникальный ключ элемента.
- `groupId?: string | number` — идентификатор группы (если используются группы).
- `disabled?: boolean` — флаг неактивного элемента.

Для кастомных типов данных используйте геттеры, описанные в [Кастомные типы данных](#кастомные-типы-данных).

<MdxTabs>

<SelectExampleItems />

```tsx
const items = [
  { label: 'Первый', id: 1 },
  { label: 'Второй', id: 2 },
  { label: 'Третий', id: 3 },
];
const [value, setValue] = useState(null);
return <Select items={items} value={value} onChange={setValue} />;
```

</MdxTabs>

### Выбранное значение

Свойство `value` задаёт текущее выбранное значение (один элемент или массив при `multiple`). Для обработки выбора используйте `onChange`, который возвращает выбранное значение и событие. Выбор срабатывает по клику или нажатию `Enter`.

<MdxTabs>

<SelectExampleItems />

```tsx
const items = [
  { label: 'Первый', id: 1 },
  { label: 'Второй', id: 2 },
  { label: 'Третий', id: 3 },
];
const [value, setValue] = useState(null);
return <Select items={items} value={value} onChange={setValue} />;
```

</MdxTabs>

### Подсказка

Свойство `placeholder` задаёт текст, отображаемый, когда ничего не выбрано. Рекомендуется использовать лаконичный текст, например, «Выберите».

<MdxTabs>

<SelectExamplePlaceholder />

```tsx
<Select placeholder="Выберите вариант" />
```

</MdxTabs>

### Неактивный элемент списка

Чтобы сделать элемент списка неактивным, добавьте в объект `items` свойство `disabled: true`.

<MdxTabs>

<SelectExampleDisabledItem />

```tsx
const items = [
  { label: 'Первый — этот вариант не выбрать', id: 1, disabled: true },
  { label: 'Второй', id: 2, disabled: false },
  { label: 'Третий — и этот тоже не выбрать', id: 3, disabled: true },
];
const [value, setValue] = useState(null);
return (
  <Select
    placeholder="Выберите вариант"
    items={items}
    value={value}
    onChange={setValue}
  />
);
```

</MdxTabs>

### Множественный выбор

Для выбора нескольких элементов установите `multiple`. В этом случае `value` и `onChange` работают с массивом элементов.

<MdxTabs>

<SelectExampleMultiple />

```tsx
const items = [
  { label: 'Первый', id: 1 },
  { label: 'Второй', id: 2 },
  { label: 'Третий', id: 3 },
];
const [value, setValue] = useState(null);
return (
  <Select
    placeholder="Выберите вариант"
    items={items}
    value={value}
    onChange={setValue}
    multiple
  />
);
```

</MdxTabs>

### Группы вариантов

Для группировки элементов используйте свойство `groups` (тип по умолчанию — `SelectGroupDefault`):

- `label: string` — название группы.
- `id: string | number` — уникальный ключ группы.

Связь элементов с группами задаётся через `groupId` в `items`.

<MdxTabs>

<SelectExampleGroups />

```tsx
const groups = [
  { id: 1, label: 'Первая группа' },
  { id: 2, label: 'Вторая группа' },
  { id: 3, label: 'Третья группа' },
];
const items = [
  { label: 'Первый', id: 1, groupId: 1 },
  { label: 'Второй', id: 2, groupId: 2 },
  { label: 'Третий', id: 3, groupId: 1 },
  { label: 'Четвертый', id: 4, groupId: 3 },
  { label: 'Пятый', id: 5, groupId: 2 },
];
const [value, setValue] = useState(null);
return (
  <Select
    placeholder="Выберите вариант"
    items={items}
    value={value}
    onChange={setValue}
    groups={groups}
  />
);
```

</MdxTabs>

### Кнопка очистки поля

Свойство `clearButton` включает кнопку для очистки значений `value` и `searchValue`.

<MdxTabs>

<SelectExampleClearButton />

```tsx
<Select clearButton />
```

</MdxTabs>

## Внешний вид

### Размер

Свойство `size` задаёт размер компонента: `'xs'`, `'s'`, `'m'`, `'l'` (по умолчанию `'m'`). Компонент занимает всю ширину контейнера.

<MdxTabs>

<SelectExampleSize />

```tsx
<Select size="xs" />
<Select size="s" />
<Select size="m" />
<Select size="l" />
```

</MdxTabs>

### Стиль

Свойство `view` определяет стиль: `'default'` (по умолчанию) или `'clear'` (для кастомных контейнеров, без встроенных эффектов hover/focus).

<MdxTabs>

<SelectExampleView />

```tsx
<Select view="default" />
<Select view="clear" />
```

</MdxTabs>

### Форма

Свойство `form` задаёт форму компонента: `'default'`, `'brick'`, `'round'`, `'clear'`, и их комбинации (например, `'brickClear'`). По умолчанию — `'default'`.

### Статус

Свойство `status` выделяет поле визуально: `''` (обычное), `'alert'` (ошибка), `'success'` (успех), `'warning'` (предупреждение).

<MdxTabs>

<SelectExampleStatus />

```tsx
<Select status="alert" />
<Select status="success" />
<Select status="warning" />
```

</MdxTabs>

## Поведение

### Неактивный компонент

Свойство `disabled` делает весь компонент неактивным.

<MdxTabs>

<SelectExampleDisabled />

```tsx
<Select disabled />
```

</MdxTabs>

### Поиск

Для включения поиска используйте свойства:

- `input` — включает текстовое поле.
- `onInput` — обрабатывает изменения в поле.
- `labelForEmptyItems` — текст при пустом списке.

Хук `useSearch` упрощает фильтрацию по свойству `label`.

<MdxTabs>

<SelectExampleSearch />

```tsx
const items = [
  { firstName: 'Илья', lastName: 'Васильев', role: 'Руководитель', id: 1 },
  { firstName: 'Михаил', lastName: 'Гусев', role: 'Разработчик', id: 2 },
  { firstName: 'Василий', lastName: 'Жмых', role: 'Дизайнер', id: 3 },
  { firstName: 'Василий', lastName: 'Белый', role: 'Разработчик', id: 4 },
];
const getItemLabel = ({ firstName, lastName }) => `${firstName} ${lastName}`;
const [value, setValue] = useState(null);
const [searchValue, setSearchValue] = useState('');
const setSearchValueDebounce = useDebounce(setSearchValue, 300);
const itemsFiltered = useMemo(() => {
  const searchWords = searchValue.trim().split(' ');
  const propsToSearch = ['firstName', 'lastName', 'role'];
  const weights = {};
  for (let index = 0; index < items.length; index++) {
    const item = items[index];
    let weight = 0;
    for (let i = 0; i < searchWords.length; i++) {
      const word = searchWords[i].toLocaleLowerCase();
      for (let j = 0; j < propsToSearch.length; j++) {
        if (item[propsToSearch[j]].toLocaleLowerCase().includes(word)) {
          weight++;
        }
      }
    }
    weights[item.id] = weight;
  }
  return items
    .filter((item) => weights[item.id])
    .sort((a, b) => weights[b.id] - weights[a.id]);
}, [searchValue]);
return (
  <Select
    items={itemsFiltered}
    getItemLabel={getItemLabel}
    placeholder="Выберите вариант"
    value={value}
    onChange={setValue}
    clearButton
    onInput={setSearchValueDebounce}
    input
  />
);
```

</MdxTabs>

<MdxTabs>

<SelectExampleUseSearch />

```tsx
const items = [
  { label: 'Первый', id: 1 },
  { label: 'Второй', id: 2 },
  { label: 'Третий', id: 3 },
  { label: 'Четвертый', id: 4 },
  { label: 'Пятый', id: 5 },
];
const [value, setValue] = useState(null);
return (
  <Select
    {...useSearch({ items })}
    placeholder="Выберите вариант"
    value={value}
    onChange={setValue}
    clearButton
  />
);
```

</MdxTabs>

### Создание новых вариантов

Свойство `onCreate` позволяет добавлять новые элементы в список. Передаётся `label` введённого значения.

<MdxTabs>

<SelectExampleCreate />

```tsx
const [value, setValue] = useState(null);
const [list, setList] = useState(['Первый', 'Второй', 'Третий']);
const { items, labelForEmptyItems, onInput } = useSearch({
  items: list,
  search: (item, searchValue) =>
    item.toLowerCase().includes(searchValue.toLowerCase()),
});
const onCreate = (label) => setList([label, ...list]);
return (
  <Select
    placeholder="Выберите вариант"
    items={items}
    value={value}
    onChange={setValue}
    getItemLabel={(item) => item}
    getItemKey={(item) => item}
    onCreate={!items.length ? onCreate : undefined}
    labelForEmptyItems={labelForEmptyItems}
    onInput={onInput}
    input
  />
);
```

</MdxTabs>

### Виртуализация списка

Свойство `virtualScroll` оптимизирует отображение больших списков.

<MdxTabs>

<SelectExampleVirtualScroll />

```tsx
const items = new Array(1000).fill(null).map((_, i) => ({
  label: `Опция ${i + 1}`,
  groupId: Math.floor(i / 100) + 1,
  id: i,
}));
const groups = new Array(items.length / 100).fill(null).map((_, i) => ({
  id: i + 1,
  label: `Группа ${i + 1}`,
}));
const [value, setValue] = useState(null);
return (
  <Select
    placeholder="Чтобы посмотреть весь список, прокрутите вниз"
    items={items}
    value={value}
    onChange={setValue}
    groups={groups}
    multiple
    selectAll
    virtualScroll
    renderValue={({ value, getRemove }) => {
      if (value.length >= 200)
        return (
          <div
            style={{
              height: 'var(--field-array-value-inline-control-input-height)',
              lineHeight:
                'var(--field-array-value-inline-control-input-height)',
            }}
          >{`Выбрано ${value.length} элементов`}</div>
        );
      return value.map((item) => (
        <FieldArrayValueItem
          key={item.id}
          size="m"
          label={item.label}
          onRemove={getRemove(item)}
        />
      ));
    }}
  />
);
```

</MdxTabs>

### Индикация загрузки

Свойство `isLoading` включает индикатор загрузки. Для дозагрузки данных при прокрутке используйте `onScrollToBottom`.

<MdxTabs>

<SelectExampleIsLoading />

```tsx
const [value, setValue] = useState(null);
return (
  <Select
    placeholder="Кликните по полю ввода"
    items={[]}
    value={value}
    onChange={setValue}
    multiple
    isLoading
  />
);
```

</MdxTabs>

<MdxTabs>

<SelectExampleIsLoadingOnScrollBottom />

```tsx
const useMockLoadData = (searchValue = '') => {
  const [isLoading, setIsLoading] = useFlag();
  const [isStart, setIsStart] = useFlag();
  const [length, setLength] = useState(0);
  const isLoadingOffDebounce = useDebounce(setIsLoading.off, 2000);
  const items = useMemo(() => {
    if (searchValue) {
      return new Array(10000)
        .fill(null)
        .map((_, i) => ({
          label: `Опция ${i + 1}`,
          id: i,
        }))
        .filter((item) =>
          item.label
            .toLocaleLowerCase()
            .includes(searchValue.toLocaleLowerCase()),
        );
    }
    return new Array(length).fill(null).map((_, i) => ({
      label: `Опция ${i + 1}`,
      id: i,
    }));
  }, [length, searchValue]);
  useEffect(() => {
    setIsLoading.on();
    isLoadingOffDebounce();
  }, [searchValue]);
  useEffect(() => {
    if (isStart) {
      setIsLoading.on();
      const timeout = setTimeout(() => {
        setLength((state) => state + 100);
        setIsLoading.off();
        setIsStart.off();
      }, 2000);
      return () => clearTimeout(timeout);
    }
  }, [isStart]);
  useEffect(() => {
    return () => {
      setIsLoading.off();
      setIsStart.off();
    };
  }, []);
  return [searchValue && isLoading ? [] : items, isLoading, setIsStart.on];
};
const [value, setValue] = useState(null);
const [searchValue, setSearchValue] = useState('');
const [data, isLoading, load] = useMockLoadData(searchValue);
return (
  <Select
    placeholder="Кликните по полю ввода, чтобы данные загрузились"
    items={data}
    value={value}
    onChange={setValue}
    multiple
    isLoading={isLoading}
    virtualScroll
    onScrollToBottom={searchValue ? undefined : load}
    searchFunction={() => true}
    onSearchValueChange={setSearchValue}
  />
);
```

</MdxTabs>

### Выбор всех элементов

Свойство `selectAll` добавляет пункт для выбора всех элементов. Текст пункта можно настроить через `allSelectedAllLabel`.

<MdxTabs>

<SelectExampleSelectAll />

```tsx
const groups = [
  { id: 1, label: 'Первая группа' },
  { id: 2, label: 'Вторая группа' },
  { id: 3, label: 'Третья группа' },
];
const items = [
  { label: 'Первый', id: 1, groupId: 1 },
  { label: 'Второй', id: 2, groupId: 2 },
  { label: 'Третий', id: 3, groupId: 1 },
  { label: 'Четвертый', id: 4, groupId: 3 },
  { label: 'Пятый', id: 5, groupId: 2 },
];
const [value, setValue] = useState(null);
return (
  <Select
    placeholder="Выберите варианты"
    items={items}
    value={value}
    multiple
    selectAll
    allSelectedAllLabel="Все варианты"
    onChange={setValue}
    groups={groups}
  />
);
```

</MdxTabs>

### Управление состоянием выпадающего списка

Для управления состоянием списка используйте:

- `dropdownOpen` — флаг открытия/закрытия.
- `onDropdownOpen` — обработчик открытия/закрытия.
- `ignoreOutsideClicksRefs` — элементы, игнорируемые при клике вне компонента.

<MdxTabs>

<SelectExampleDropdownOpen />

```tsx
const items = [
  { label: 'Первый', id: 1 },
  { label: 'Второй', id: 2 },
  { label: 'Третий', id: 3 },
];
const Icon = withAnimateSwitcherHOC({
  startIcon: IconArrowDown,
  startDirection: 0,
  endDirection: 180,
});
const [value, setValue] = useState(null);
const [open, setOpen] = useFlag();
const buttonRef = useRef(null);
const inputRef = useRef(null);
const onDropdownOpen = (open) => {
  setOpen.set(open);
  if (open) inputRef.current?.focus();
};
return (
  <AnimateIconSwitcherProvider active={open}>
    <FieldGroup>
      <Button
        ref={buttonRef}
        label={open ? 'Закрыть' : 'Открыть'}
        onClick={setOpen.toggle}
        iconLeft={Icon}
        onlyIcon
      />
      <Select
        inputRef={inputRef}
        placeholder="Выберите вариант"
        items={items}
        value={value}
        onChange={setValue}
        dropdownOpen={open}
        onDropdownOpen={onDropdownOpen}
        ignoreOutsideClicksRefs={[buttonRef]}
      />
    </FieldGroup>
  </AnimateIconSwitcherProvider>
);
```

</MdxTabs>

<MdxTabs>

<SelectExampleOpenByFocus />

```tsx
const items = [
  { label: 'Первый', id: 1 },
  { label: 'Второй', id: 2 },
  { label: 'Третий', id: 3 },
];
const [value, setValue] = useState(null);
const [isOpened, setIsOpened] = useFlag();
const inputRef = useRef(null);
const handleFocus = () => inputRef.current?.focus();
return (
  <>
    <Button onClick={handleFocus} label="Эмулировать фокус на элемент" />
    <Select
      inputRef={inputRef}
      items={items}
      value={value}
      onChange={setValue}
      placeholder="Выберите элемент"
      dropdownOpen={isOpened}
      onDropdownOpen={setIsOpened.set}
      onFocus={setIsOpened.on}
    />
  </>
);
```

</MdxTabs>

## Кастомизация

### Кастомный элемент списка

Свойство `renderItem` позволяет настроить отображение элементов списка через функцию рендера.

<MdxTabs>

<SelectExampleRenderItem />

```tsx
const items = [
  { label: 'Принтер', id: 1, status: 'repairs' },
  { label: 'Монитор', id: 2, status: 'serviceable' },
  { label: 'Ноутбук', id: 3, status: 'serviceable' },
  { label: 'Стол', id: 4 },
];
const mapLabel = { repairs: 'На ремонте', serviceable: 'Исправен' };
const mapStatus = { repairs: 'error', serviceable: 'success' };
const searchFunction = (item, searchValue) => {
  const searchOfLabel = item.label
    .toLocaleLowerCase()
    .includes(searchValue.toLocaleLowerCase());
  if (searchOfLabel) return searchOfLabel;
  return (
    item.status &&
    mapLabel[item.status]
      .toLocaleLowerCase()
      .includes(searchValue.toLocaleLowerCase())
  );
};
const [value, setValue] = useState(null);
return (
  <Select
    {...useSearch({ items, search: searchFunction })}
    placeholder="Выберите вариант"
    clearButton
    value={value}
    onChange={setValue}
    renderItem={({ item, active, hovered, onClick, onMouseEnter, ref }) => (
      <div
        className={cnSelectExampleRenderItem('Item', { active, hovered })}
        aria-selected={active}
        aria-hidden="true"
        onMouseEnter={onMouseEnter}
        onClick={onClick}
        ref={ref}
      >
        {item.label}
        {item.status && (
          <Badge
            className={cnSelectExampleRenderItem('Badge')}
            as="span"
            size="s"
            label={mapLabel[item.status]}
            status={mapStatus[item.status]}
          />
        )}
      </div>
    )}
  />
);
```

```css
.SelectExampleRenderItem {
  &-Item {
    --text-color: var(--color-control-typo-default);
    position: relative;
    padding: var(--space-xs) var(--space-l);
    color: var(--text-color);
    &_hovered {
      background-color: var(--color-control-bg-clear-hover);
    }
    &_active {
      --text-color: var(--color-control-typo-secondary);
    }
    &_disabled {
      --text-color: var(--color-control-typo-disable);
    }
    &::before {
      content: '';
      position: absolute;
      top: calc(50% - 6px);
      left: 6px;
      width: 8px;
      height: 8px;
      background-color: var(--color-control-typo-disable);
      border-radius: 50%;
      transition: background-color 0.2s ease-in;
    }
    &_active::before {
      background-color: var(--text-color);
    }
  }
  &-Badge {
    margin-left: var(--space-m);
  }
}
```

</MdxTabs>

### Кастомное выбранное значение

Свойство `renderValue` позволяет настроить отображение выбранного значения.

<MdxTabs>

<SelectExampleRenderValue />

```tsx
const items = [
  { label: 'Первый', id: 1 },
  { label: 'Второй', id: 2 },
  { label: 'Третий', id: 3 },
];
const [value, setValue] = useState(null);
return (
  <Select
    placeholder="Выберите вариант"
    items={items}
    value={value}
    onChange={setValue}
    renderValue={({ value }) => (
      <div
        style={{
          height: 'var(--field-control-layout-slot-height)',
          lineHeight: 'var(--field-control-layout-slot-height)',
        }}
      >
        <span role="img" aria-label="Panda">
          🐼
        </span>{' '}
        — {value.label}
      </div>
    )}
  />
);
```

</MdxTabs>

### Кастомные типы данных

Для использования кастомных типов данных задайте геттеры: `getItemLabel`, `getItemKey`, `getItemGroupKey`, `getItemDisabled`, `getGroupLabel`, `getGroupKey`.

```tsx
const items = ['Первый', 'Второй', 'Третий'];
const [value, setValue] = useState(null);
return (
  <Select
    placeholder="Выберите вариант"
    items={items}
    value={value}
    onChange={setValue}
    getItemKey={(item) => item}
    getItemLabel={(item) => item}
  />
);
```

```tsx
const items = [
  { name: 'Первый', group: 'Первая группа' },
  { name: 'Второй', group: 'Третья группа' },
  { name: 'Третий', group: 'Вторая группа' },
  { name: 'Четвертый', group: 'Первая группа' },
  { name: 'Пятый', group: 'Первая группа' },
  { name: 'Шестой', group: 'Третья группа' },
  { name: 'Седьмой', group: 'Первая группа' },
  { name: 'Восьмой', group: 'Вторая группа' },
  { name: 'Девятый', group: 'Третья группа' },
  { name: 'Десятый', group: 'Вторая группа' },
];
const groups = ['Первая группа', 'Вторая группа', 'Третья группа'];
const [value, setValue] = useState(null);
return (
  <Select
    placeholder="Выберите вариант"
    items={items}
    groups={groups}
    value={value}
    onChange={setValue}
    getItemKey={(item) => item.name}
    getItemLabel={(item) => item.name}
    getItemGroupKey={(item) => item.group}
    getGroupKey={(group) => group}
    getGroupLabel={(group) => group}
  />
);
```
