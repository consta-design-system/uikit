import { MdxMenu, MdxTabs } from '@consta/stand';
import {
  TooltipPositionedCoords,
  TooltipPositionedAnchor,
} from './examples/TooltipPosition/TooltipPosition';

import { TooltipViewportExample } from './examples/TooltipViewportExample/TooltipViewportExample';

<MdxMenu>

- [Обзор](#обзор)
- [Импорт](#импорт)
- [Свойства](#свойства)
- [Содержимое](#содержимое)
  - [Контент тултипа](#контент-тултипа)
- [Внешний вид](#внешний-вид)
  - [Тема](#тема)
  - [Размер](#размер)
  - [Статус](#статус)
- [Позиционирование](#позиционирование)
  - [Элемент-якорь](#элемент-якорь)
  - [Координаты](#координаты)
  - [Viewport](#viewport)
- [Пример использования](#пример-использования)

</MdxMenu>

## Обзор

Компонент `Tooltip` предназначен для отображения всплывающих подсказок с информацией. Он используется для предоставления дополнительного контекста или пояснений к элементам интерфейса. Подсказка может позиционироваться относительно элемента-якоря или координат, а также поддерживает настройку внешнего вида и поведения.

Компонент основан на [Popover](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-popover-stable/tab:dev) и наследует его возможности позиционирования.

## Импорт

```tsx
import { Tooltip } from '@consta/uikit/Tooltip';
```

## Свойства

| Свойство                                   | Тип или варианты значения                     | По умолчанию               | Описание                                                                                                                                                    |
| ------------------------------------------ | --------------------------------------------- | -------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [`children`](#контент-тултипа)             | `React.ReactNode`                             | -                          | Контент тултипа                                                                                                                                             |
| [`size`](#размер)                          | `'s', 'm', 'l'`                               | `'m'`                      | Размер, влияющий на максимальную ширину тултипа                                                                                                             |
| [`status?`](#статус)                       | `'normal', 'success', 'warning', 'alert'`     | -                          | Статус для выделения типа сообщения                                                                                                                         |
| [`direction?`](#позиционирование)          | `Direction`                                   | `'upCenter'`               | Направление разворачивания тултипа. См. [Popover](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-popover-stable/tab:dev/hash:направление-разворачивания)   |
| [`possibleDirections?`](#позиционирование) | `Direction[]`                                 | все возможные `Direction`  | Возможные направления разворачивания. См. [Popover](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-popover-stable/tab:dev/hash:направление-разворачивания) |
| [`spareDirection?`](#позиционирование)     | `Direction`                                   | `'downStartLeft'`          | Запасное направление разворачивания. См. [Popover](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-popover-stable/tab:dev/hash:направление-разворачивания)  |
| [`anchorRef?`](#элемент-якорь)             | `React.RefObject<HTMLElement>`                | -                          | Ссылка на элемент-якорь. См. [Popover](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-popover-stable/tab:dev)                                              |
| `isOpen?`                                  | `boolean`                                     | -                          | Состояние тултипа (открыт/закрыт)                                                                                                                           |
| [`position?`](#координаты)                 | `{ x: number; y: number }` &#124; `undefined` | -                          | Координаты для позиционирования. См. [Popover](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-popover-stable/tab:dev)                                      |
| [`viewportRef?`](#viewport)                | `React.RefObject<HTMLElement>`                | `document.documentElement` | Элемент, определяющий область видимости тултипа                                                                                                             |
| [`isInteractive?`](#позиционирование)      | `boolean`                                     | `true`                     | Включает/отключает интерактивность тултипа. См. [Popover](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-popover-stable/tab:dev)                           |
| [`offset?`](#позиционирование)             | `number`                                      | `0`                        | Отступ от якоря или позиции                                                                                                                                 |
| [`equalAnchorWidth?`](#позиционирование)   | `boolean`                                     | `false`                    | Уравнивает ширину тултипа с шириной якоря. См. [Popover](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-popover-stable/tab:dev)                            |
| `className`                                | `string`                                      | -                          | Дополнительные CSS-классы                                                                                                                                   |
| `ref`                                      | `React.Ref<HTMLElement>`                      | -                          | Ссылка на DOM-элемент                                                                                                                                       |

## Содержимое

### Контент тултипа

Свойство `children` определяет содержимое тултипа. Это может быть текст, компоненты или любой другой React-элемент. Например, текст внутри тултипа можно оформить с помощью компонента `Text` из Consta UI Kit для настройки размера, стиля или других параметров.

```tsx
<Tooltip isOpen size="s">
  <Text view="primary" size="xs" lineHeight="m">
    Текст тултипа
  </Text>
</Tooltip>
```

## Внешний вид

### Тема

Содержимое тултипа использует инвертированную тему: в светлой теме тултип отображается тёмным, в тёмной — светлым.

### Размер

Свойство `size` задаёт максимальную ширину тултипа. Доступные значения: `'s'`, `'m'`, `'l'`. Размер влияет только на ширину, а высота определяется содержимым.

### Статус

Свойство `status` позволяет выделить тип сообщения в тултипе с помощью цветового акцента. Доступные значения:

- `normal` — нейтральный стиль (по умолчанию).
- `success` — для успешных уведомлений.
- `warning` — для предупреждений.
- `alert` — для ошибок.

## Позиционирование

Компонент `Tooltip` поддерживает позиционирование с помощью свойств, унаследованных от [Popover](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-popover-stable/tab:dev). Тултип можно разместить относительно элемента-якоря или по координатам. Свойства `direction`, `possibleDirections`, `spareDirection`, `isInteractive`, `offset` и `equalAnchorWidth` определяют поведение позиционирования.

### Элемент-якорь

Свойство `anchorRef` позволяет привязать тултип к элементу-якорю. Для управления видимостью используется свойство `isOpen`. Пример:

<MdxTabs>

<TooltipPositionedAnchor />

```tsx
export const TooltipPositionedAnchor = () => {
  const anchorRef = useRef<HTMLButtonElement>(null);
  const [isTooltipVisible, setIsTooltipVisible] = useFlag();

  return (
    <>
      <div className={cnTooltipPosition()}>
        <Button
          label="Нажми меня"
          type="button"
          onClick={setIsTooltipVisible.toggle}
          ref={anchorRef}
        />
      </div>
      <Tooltip
        isOpen={isTooltipVisible}
        direction="upCenter"
        spareDirection="downStartLeft"
        possibleDirections={directions}
        size={tooltipPropSizesDefault}
        anchorRef={anchorRef}
      >
        <Text view="primary" lineHeight="m" size="xs">
          Текст тултипа
        </Text>
      </Tooltip>
    </>
  );
};
```

</MdxTabs>

### Координаты

Свойство `position` задаёт координаты `{ x: number, y: number }` для позиционирования тултипа. Это полезно для динамического отображения, например, при движении мыши.

<MdxTabs>

<TooltipPositionedCoords />

```tsx
export const TooltipPositionedCoords = () => {
  const [position, setPosition] = useState<Position>(undefined);

  const handleMouseMove = (event: React.MouseEvent) => {
    setPosition({ x: event.clientX, y: event.clientY });
  };

  return (
    <>
      <div
        onMouseMove={handleMouseMove}
        onMouseLeave={() => setPosition(undefined)}
      >
        <Text view="primary" size="m" lineHeight="m">
          Область, в которой работает отслеживание мышки
        </Text>
      </div>
      <Tooltip
        isOpen
        direction="upCenter"
        spareDirection="downStartLeft"
        possibleDirections={directions}
        size={tooltipPropSizesDefault}
        position={position}
        isInteractive={false}
      >
        <Text size="xs" view="primary" lineHeight="m">
          Текст тултипа
        </Text>
      </Tooltip>
    </>
  );
};
```

</MdxTabs>

### Viewport

Свойство `viewportRef` позволяет задать элемент, который будет использоваться как область видимости (вьюпорт) для тултипа. По умолчанию используется `document.documentElement`. Это полезно, когда тултип не должен выходить за границы контейнера со скроллом.

<MdxTabs>

<TooltipViewportExample />

```tsx
import './TooltipViewportExample.css';

import { Example } from '@consta/stand';
import React from 'react';

import { Badge } from '##/components/Badge';
import { Grid, GridItem } from '##/components/Grid';
import { Tooltip } from '##/components/Tooltip';
import { useRefs } from '##/hooks/useRefs';
import { cnMixFlex } from '##/mixs/MixFlex';
import { cnMixScrollBar } from '##/mixs/MixScrollBar';
import { range } from '##/utils/array';
import { cn } from '##/utils/bem';

const cnTooltipViewportExample = cn('TooltipViewportExample');

const cols = 5;
const rows = 10;

const items = range(cols * rows);

export const TooltipViewportExample = () => {
  const refs = useRefs<HTMLDivElement>(items.length + 1);

  return (
    <>
      <Example col={1}>
        <div
          ref={refs[0]}
          className={cnTooltipViewportExample(null, cnMixScrollBar())}
        >
          <Grid cols={cols} className={cnTooltipViewportExample('Wrapper')}>
            {items.map((item, index) => (
              <GridItem
                className={cnTooltipViewportExample('Item', [
                  cnMixFlex({
                    flex: 'flex',
                    align: 'center',
                    justify: 'center',
                  }),
                ])}
              >
                <Badge
                  ref={refs[index + 1]}
                  label={item.toString()}
                  form="round"
                />
              </GridItem>
            ))}
          </Grid>
        </div>
      </Example>
      {items.map((item, index) => (
        <Tooltip
          direction="upCenter"
          possibleDirections={[
            'upCenter',
            'downCenter',
            'rightCenter',
            'leftCenter',
          ]}
          spareDirection="upCenter"
          isInteractive
          viewportRef={refs[0]}
          anchorRef={refs[index + 1]}
          isOpen
        >
          {`для ${item}`}
        </Tooltip>
      ))}
    </>
  );
};
```

</MdxTabs>

## Пример использования

Базовый пример использования компонента `Tooltip`:

```tsx
<Tooltip isOpen size="s" position={{ x: 100, y: 200 }}>
  Контент тултипа
</Tooltip>
```
