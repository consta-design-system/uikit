import { AutoCompleteExampleItems } from './examples/AutoCompleteExampleItems/AutoCompleteExampleItems';
import { AutoCompleteExampleDisabled } from './examples/AutoCompleteExampleDisabled/AutoCompleteExampleDisabled';
import {
  AutoCompleteExampleForm,
  AutoCompleteExampleDropdownForm,
} from './examples/AutoCompleteExampleForm/AutoCompleteExampleForm';
import { AutoCompleteExampleGroups } from './examples/AutoCompleteExampleGroups/AutoCompleteExampleGroups';
import { AutoCompleteExampleLabel } from './examples/AutoCompleteExampleLabel/AutoCompleteExampleLabel';
import { AutoCompleteExamplePlaceholder } from './examples/AutoCompleteExamplePlaceholder/AutoCompleteExamplePlaceholder';
import { AutoCompleteExampleRenderItem } from './examples/AutoCompleteExampleRenderItem/AutoCompleteExampleRenderItem';
import { AutoCompleteExampleSize } from './examples/AutoCompleteExampleSize/AutoCompleteExampleSize';
import { AutoCompleteExampleStatus } from './examples/AutoCompleteExampleStatus/AutoCompleteExampleStatus';
import {
  AutoCompleteExampleType,
  AutoCompleteExampleTypeEmail,
} from './examples/AutoCompleteExampleType/AutoCompleteExampleType';
import { AutoCompleteExampleView } from './examples/AutoCompleteExampleView/AutoCompleteExampleView';
import { AutoCompleteExampleVirtualScroll } from './examples/AutoCompleteExampleVirtualScroll/AutoCompleteExampleVirtualScroll';
import { AutoCompleteExampleDropdownOpen } from './examples/AutoCompleteExampleDropdownOpen/AutoCompleteExampleDropdownOpen';
import {
  AutoCompleteExampleIsLoading,
  AutoCompleteExampleOnScrollBottom,
} from './examples/AutoCompleteExampleIsLoading/AutoCompleteExampleIsLoading';
import { MdxMenu, MdxInformer, MdxTabs } from '@consta/stand';

<MdxMenu>

- [Обзор](#обзор)
- [Импорт](#импорт)
- [Свойства](#свойства)
- [Содержимое](#содержимое)
  - [Группы подсказок](#группы-подсказок)
  - [Подсказки](#подсказки)
  - [Поиск](#поиск)
  - [Подсказка в поле](#подсказка-в-поле)
- [Внешний вид](#внешний-вид)
  - [Тип поля](#тип-поля)
  - [Заголовок и подпись](#заголовок-и-подпись)
  - [Статус](#статус)
  - [Размер](#размер)
  - [Форма поля](#форма-поля)
  - [Форма списка](#форма-списка)
  - [Внешний вид](#внешний-вид)
- [Поведение](#поведение)
  - [Виртуализация списка](#виртуализация-списка)
  - [Индикация загрузки](#индикация-загрузки)
  - [Неактивное поле](#неактивное-поле)
  - [Состояние списка](#состояние-списка)
- [Кастомный элемент списка](#кастомный-элемент-списка)
- [Пример использования](#пример-использования)

</MdxMenu>

## Обзор

Компонент `AutoComplete` представляет собой поле ввода с динамическими подсказками, появляющимися при вводе текста. Он подходит для упрощения выбора из большого списка вариантов, таких как адреса электронной почты, цвета или категории.

Типичные сценарии использования:

- Автозаполнение адресов электронной почты.
- Поиск по списку категорий или тегов.
- Выбор элементов из большого набора данных с группировкой.

## Импорт

```tsx
import { AutoComplete } from '@consta/uikit/AutoComplete';
```

## Свойства

```tsx
type AutoCompleteItemDefault = {
  id: string | number;
  label: string;
  groupId?: number;
};

type AutoCompleteGroupDefault = {
  label: string;
  id: number | string;
};

type AutoCompletePropDropdownForm = 'default' | 'brick' | 'round';

type AutoCompletePropGetItemLabel<ITEM> = (item: ITEM) => string;
type AutoCompletePropGetItemKey<ITEM> = (item: ITEM) => string | number;
type AutoCompletePropGetItemGroupId<ITEM> = (item: ITEM) => number | undefined;
type AutoCompletePropGetGroupLabel<GROUP> = (group: GROUP) => string;
type AutoCompletePropGetGroupId<GROUP> = (group: GROUP) => number | string;

type AutoCompletePropOnChange = (
  value: string | null,
  props: {
    e: React.ChangeEvent | React.MouseEvent | React.KeyboardEvent;
    id?: string;
    name?: string;
  },
) => void;
```

| Свойство                                                                                                                        | Тип                                                                                                                                                                                       | По умолчанию             | Описание                                             |
| ------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------ | ---------------------------------------------------- |
| [`items`](#подсказки)                                                                                                           | `ITEM[]`                                                                                                                                                                                  | -                        | Объект с подсказками, появляющимися при вводе текста |
| [`groups?`](#группы-подсказок)                                                                                                  | `GROUP[]`                                                                                                                                                                                 | -                        | Группы подсказок                                     |
| [`type?`](#тип-поля)                                                                                                            | `'text' \| 'textarea'`                                                                                                                                                                    | `'text'`                 | Тип поля и соответствующий тег в DOM                 |
| [`status?`](#статус)                                                                                                            | `'' \| 'alert' \| 'success' \| 'warning'`                                                                                                                                                 | `''`                     | Визуальный статус поля                               |
| [`disabled?`](#неактивное-поле)                                                                                                 | `boolean`                                                                                                                                                                                 | -                        | Делает поле неактивным                               |
| [`size?`](#размер)                                                                                                              | `'xs' \| 's' \| 'm' \| 'l'`                                                                                                                                                               | `'m'`                    | Размер шрифта, отступов и высоты поля                |
| [`rows?`](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-textfield-stable/tab:dev/hash:строки-и-колонки)                       | `number`                                                                                                                                                                                  | -                        | Количество строк для `type='textarea'`               |
| [`cols?`](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-textfield-stable/tab:dev/hash:строки-и-колонки)                       | `number`                                                                                                                                                                                  | -                        | Количество колонок для `type='textarea'`             |
| [`minRows?`](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-textfield-stable/tab:dev/hash:минимальная-и-максимальная-высота)   | `number`                                                                                                                                                                                  | -                        | Минимальное количество строк для `type='textarea'`   |
| [`maxRows?`](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-textfield-stable/tab:dev/hash:минимальная-и-максимальная-высота)   | `number`                                                                                                                                                                                  | -                        | Максимальное количество строк для `type='textarea'`  |
| [`maxLength?`](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-textfield-stable/tab:dev/hash:минимальная-и-максимальная-высота) | `number`                                                                                                                                                                                  | -                        | Максимальная длина вводимого текста                  |
| [`withClearButton?`](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-textfield-stable/tab:dev/hash:кнопка-для-очистки-поля)     | `boolean`                                                                                                                                                                                 | `false`                  | Отображение кнопки очистки поля                      |
| [`view?`](#вид)                                                                                                                 | `'default' \| 'clear'`                                                                                                                                                                    | `'default'`              | Внешний вид поля                                     |
| `label?`                                                                                                                        | `string`                                                                                                                                                                                  | -                        | Заголовок поля                                       |
| `labelIcon?`                                                                                                                    | `IconComponent`                                                                                                                                                                           | -                        | Иконка слева от заголовка                            |
| `labelPosition?`                                                                                                                | `'top' \| 'left'`                                                                                                                                                                         | `'top'`                  | Положение заголовка                                  |
| `caption?`                                                                                                                      | `string`                                                                                                                                                                                  | -                        | Подпись под полем                                    |
| [`form?`](#форма-поля)                                                                                                          | `'default' \| 'brick' \| 'round' \| 'clearRound' \| 'roundClear' \| 'clearDefault' \| 'defaultClear' \| 'defaultBrick' \| 'brickDefault' \| 'brickClear' \| 'clearBrick' \| 'clearClear'` | `'default'`              | Форма поля                                           |
| [`leftSide?`](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-textfield-stable/tab:dev/hash:дополнительная-информация)          | `IconComponent \| string`                                                                                                                                                                 | -                        | Иконка или текст слева внутри поля                   |
| [`rightSide?`](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-textfield-stable/tab:dev/hash:дополнительная-информация)         | `IconComponent \| string`                                                                                                                                                                 | -                        | Иконка или текст справа внутри поля                  |
| [`value?`](#подсказка-в-поле)                                                                                                   | `string \| null`                                                                                                                                                                          | -                        | Текущее значение поля                                |
| [`placeholder?`](#подсказка-в-поле)                                                                                             | `string`                                                                                                                                                                                  | -                        | Подсказка внутри поля                                |
| `id?`                                                                                                                           | `string`                                                                                                                                                                                  | -                        | ID поля в DOM                                        |
| `name?`                                                                                                                         | `string`                                                                                                                                                                                  | -                        | Имя поля в DOM                                       |
| `required?`                                                                                                                     | `boolean`                                                                                                                                                                                 | -                        | Обязательность заполнения                            |
| `tabIndex?`                                                                                                                     | `number`                                                                                                                                                                                  | -                        | Порядок при переходе по Tab                          |
| `autoFocus?`                                                                                                                    | `boolean`                                                                                                                                                                                 | -                        | Автофокус на поле                                    |
| `onFocus?`                                                                                                                      | `React.FocusEventHandler<HTMLElement>`                                                                                                                                                    | -                        | Обработчик фокуса                                    |
| `onBlur?`                                                                                                                       | `React.FocusEventHandler<HTMLElement>`                                                                                                                                                    | -                        | Обработчик потери фокуса                             |
| `autoComplete?`                                                                                                                 | `AutoCompete`                                                                                                                                                                             | -                        | HTML-атрибут автозаполнения                          |
| `onChange?`                                                                                                                     | `AutoCompletePropOnChange`                                                                                                                                                                | -                        | Обработчик изменения значения                        |
| `className?`                                                                                                                    | `string`                                                                                                                                                                                  | -                        | Дополнительный CSS-класс                             |
| `inputRef?`                                                                                                                     | `React.Ref<HTMLTextAreaElement \| HTMLInputElement>`                                                                                                                                      | -                        | Ссылка на DOM-элемент поля ввода                     |
| `inputContainerRef?`                                                                                                            | `React.Ref<HTMLDivElement>`                                                                                                                                                               | -                        | Ссылка на контейнер поля ввода                       |
| `ref?`                                                                                                                          | `React.Ref<HTMLDivElement>`                                                                                                                                                               | -                        | Ссылка на корневой DOM-элемент                       |
| [`searchFunction?`](#поиск)                                                                                                     | `AutoCompletePropSearchFunction<ITEM>`                                                                                                                                                    | Поиск по `label`         | Функция поиска подсказок                             |
| [`renderItem?`](#кастомный-элемент-списка)                                                                                      | `PropRenderItem<ITEM>`                                                                                                                                                                    | Рендер по умолчанию      | Рендер-функция для элементов списка                  |
| `getItemLabel?`                                                                                                                 | `AutoCompletePropGetItemLabel<ITEM>`                                                                                                                                                      | `(item) => item.label`   | Функция получения названия элемента                  |
| `getItemKey?`                                                                                                                   | `AutoCompletePropGetItemKey<ITEM>`                                                                                                                                                        | `(item) => item.id`      | Функция получения ключа элемента                     |
| `getItemGroupKey?`                                                                                                              | `AutoCompletePropGetItemGroupKey<ITEM>`                                                                                                                                                   | `(item) => item.groupId` | Функция получения ключа группы                       |
| `getGroupLabel?`                                                                                                                | `AutoCompletePropGetGroupLabel<GROUP>`                                                                                                                                                    | `(group) => group.label` | Функция получения названия группы                    |
| `getGroupKey?`                                                                                                                  | `AutoCompletePropGetGroupKey<GROUP>`                                                                                                                                                      | `(group) => group.id`    | Функция получения ключа группы                       |
| [`isLoading?`](#индикация-загрузки)                                                                                             | `boolean`                                                                                                                                                                                 | -                        | Отображение индикатора загрузки                      |
| `dropdownClassName?`                                                                                                            | `string`                                                                                                                                                                                  | -                        | CSS-класс для выпадающего списка                     |
| [`dropdownForm?`](#форма-списка)                                                                                                | `'default' \| 'brick' \| 'round'`                                                                                                                                                         | `'default'`              | Форма выпадающего списка                             |
| `dropdownRef?`                                                                                                                  | `React.RefObject<HTMLDivElement>`                                                                                                                                                         | -                        | Ссылка на DOM-элемент списка                         |
| [`virtualScroll?`](#виртуализация-списка)                                                                                       | `boolean`                                                                                                                                                                                 | -                        | Включение виртуализации скролла                      |
| `onScrollToBottom?`                                                                                                             | `() => void`                                                                                                                                                                              | -                        | Обработчик прокрутки до конца списка                 |

## Подсказки

Список подсказок, отображаемых при вводе текста. Передается в свойстве `items` в виде массива объектов типа `AutoCompleteItemDefault`, содержащих `label` (название), `id` (уникальный ключ) и опционально `groupId` (идентификатор группы). Подсказки фильтруются по введенному тексту.

<MdxTabs>

<AutoCompleteExampleItems />

```tsx
import React, { useState } from 'react';

import { AutoComplete } from '@consta/uikit/AutoComplete';

const basicItems = ['Первый', 'Второй', 'Третий', 'Четвертый', 'Пятый'];

const AutoCompleteExampleItems = () => {
  const [value, setValue] = useState<string | null>(null);
  return (
    <AutoComplete
      type="text"
      placeholder="Введите значение"
      value={value}
      items={basicItems}
      getItemKey={(item) => item}
      getItemLabel={(item) => item}
      onChange={setValue}
    />
  );
};
```

</MdxTabs>

## Содержимое

### Группы подсказок

Позволяет группировать подсказки по категориям. Группы задаются в свойстве `groups` в виде массива объектов типа `AutoCompleteGroupDefault` с полями `label` (название группы) и `id` (уникальный ключ). Элементы связываются с группами через `groupId`.

<MdxTabs>

<AutoCompleteExampleGroups />

```tsx
import React, { useState } from 'react';

import { AutoComplete } from '@consta/uikit/AutoComplete';

type Item = {
  label: string;
  id: string | number;
  groupId?: string | number;
};

type Group = {
  label: string;
  id: string | number;
};

const items: Item[] = [
  {
    label: 'Чёрный',
    groupId: 1,
    id: 1,
  },
  {
    label: 'Белый',
    groupId: 1,
    id: 2,
  },
  {
    label: 'Синий',
    groupId: 1,
    id: 3,
  },
  {
    label: 'Красный',
    groupId: 1,
    id: 4,
  },
  {
    label: 'Сине-зелёный',
    groupId: 2,
    id: 5,
  },
  {
    label: 'Красно-коричневый',
    groupId: 2,
    id: 6,
  },
  ...
];

const groups: Group[] = [
  {
    id: 1,
    label: 'Первая группа',
  },
  {
    id: 2,
    label: 'Вторая группа',
  },
  {
    id: 3,
    label: 'Третья группа',
  },
];

const AutoCompleteExampleGroups = () => {
  const [value, setValue] = useState<string | null>(null);
  return (
      <AutoComplete
        type="text"
        placeholder="Начните вводить цвет"
        value={value}
        items={items}
        groups={groups}
       onChange={setValue}
      />
  );
};
```

</MdxTabs>

### Поиск

Функция для фильтрации подсказок, задается через свойство `searchFunction`. По умолчанию поиск выполняется по полю `label` с учетом регистра. Можно настроить кастомную логику поиска, например, по другим полям или с игнорированием регистра.

### Подсказка в поле

Текст, отображаемый в пустом поле, задается через свойство `placeholder`. Рекомендуется использовать лаконичные фразы, указывающие на действие, например, "Выберите" или "Введите значение".

<MdxTabs>

<AutoCompleteExamplePlaceholder />

```tsx
import React, { useState } from 'react';

import { AutoComplete } from '@consta/uikit/AutoComplete';

type Item = {
  label: string;
  id: number;
};

const items: Item[] = [
  {
    label: 'Первый',
    id: 1,
  },
  {
    label: 'Второй',
    id: 2,
  },
  {
    label: 'Третий',
    id: 3,
  },
];

const AutoCompleteExamplePlaceholder = () => {
  const [value, setValue] = useState<string | null>(null);
  return (
    <AutoComplete
      type="text"
      placeholder="Введите значение"
      value={value}
      items={items}
      onChange={setValue}
    />
  );
};
```

</MdxTabs>

## Внешний вид

### Тип поля

Определяет тип поля ввода через свойство `type`. Поддерживаются `text` (однострочный ввод, `<input type="text">`) и `textarea` (многострочный ввод, `<textarea>`). Также можно использовать другие HTML-типы, например, `email`.

<MdxTabs>

<AutoCompleteExampleType />

```tsx
import React, { useState } from 'react';

import { AutoComplete } from '@consta/uikit/AutoComplete';

type Item = {
  label: string;
  id: number;
};

const items: Item[] = [
  {
    label: 'Первый',
    id: 1,
  },
  {
    label: 'Второй',
    id: 2,
  },
  {
    label: 'Третий',
    id: 3,
  },
];
const AutoCompleteExampleType = () => {
  const [value, setValue] = useState<string | null>(null);
  return (
      <AutoComplete
        type="text"
        value={value}
        items={items}
       onChange={setValue}
      />
      <AutoComplete
        type="textarea"
        value={value}
        items={items}
       onChange={setValue}
      />
  );
};
```

</MdxTabs>

### Заголовок и подпись

Добавляет текстовые элементы для улучшения контекста. Свойство `label` задает заголовок, `labelPosition` (`top` или `left`) определяет его положение. Свойство `caption` добавляет подпись под полем.

<MdxTabs>

<AutoCompleteExampleLabel />

```tsx
import React, { useState } from 'react';

import { AutoComplete } from '@consta/uikit/AutoComplete';

type Item = {
  label: string;
  id: number;
};

const items: Item[] = [
  {
    label: 'Первый',
    id: 1,
  },
  {
    label: 'Второй',
    id: 2,
  },
  {
    label: 'Третий',
    id: 3,
  },
];
const AutoCompleteExampleLabel = () => {
  const [value, setValue] = useState<string | null>(null);
  return (
    <AutoComplete
      type="text"
      label="Введите значение"
      value={value}
      items={items}
      onChange={setValue}
    />
  );
};
```

</MdxTabs>

### Статус

Визуально выделяет поле через свойство `status`. Варианты: `alert` (ошибка), `success` (успех), `warning` (предупреждение) или пустое значение (обычное поле). Используется для обратной связи пользователю.

<MdxTabs>

<AutoCompleteExampleStatus />

```tsx
import React, { useState } from 'react';

import { AutoComplete } from '@consta/uikit/AutoComplete';

type Item = {
  label: string;
  id: number;
};

const items: Item[] = [
  {
    label: 'Первый',
    id: 1,
  },
  {
    label: 'Второй',
    id: 2,
  },
  {
    label: 'Третий',
    id: 3,
  },
];
const AutoCompleteExampleStatus = () => {
  const [value, setValue] = useState<string | null>(null);
  return (
      <AutoComplete
        type="text"
        placeholder="default"
        caption="default"
        value={value}
        items={items}
       onChange={setValue}
      />
      <AutoComplete
        type="text"
        value={value}
        items={items}
        placeholder="alert"
        caption="alert"
        status="alert"
       onChange={setValue}
      />
      <AutoComplete
        type="text"
        value={value}
        items={items}
        placeholder="warning"
        caption="warning"
        status="warning"
       onChange={setValue}
      />
      <AutoComplete
        type="text"
        value={value}
        items={items}
        placeholder="success"
        caption="success"
        status="success"
       onChange={setValue}
      />
  );
};
```

</MdxTabs>

### Размер

Задает размер поля через свойство `size`. Варианты: `xs`, `s`, `m`, `l`. Влияет на шрифт, отступы и высоту поля. По умолчанию `m`.

<MdxTabs>

<AutoCompleteExampleSize />

```tsx
import React, { useState } from 'react';

import { AutoComplete } from '@consta/uikit/AutoComplete';

type Item = {
  label: string;
  id: number;
};

const items: Item[] = [
  {
    label: 'Первый',
    id: 1,
  },
  {
    label: 'Второй',
    id: 2,
  },
  {
    label: 'Третий',
    id: 3,
  },
];

const AutoCompleteExampleSize = () => {
  const [value, setValue] = useState<string | null>(null);
  return (
      <AutoComplete
        type="text"
        placeholder="Размер xs"
        size="xs"
        value={value}
        items={items}
       onChange={setValue}
      />
      <AutoComplete
        type="text"
        placeholder="Размер s"
        value={value}
        items={items}
        size="s"
       onChange={setValue}
      />
      <AutoComplete
        type="text"
        placeholder="Размер m"
        value={value}
        items={items}
        size="m"
       onChange={setValue}
      />
      <AutoComplete
        type="text"
        placeholder="Размер l"
        value={value}
        items={items}
        size="l"
       onChange={setValue}
      />
  );
};
```

</MdxTabs>

### Форма поля

Определяет форму поля ввода через свойство `form`. Доступны варианты: `default`, `brick`, `round`, `clearRound`, `roundClear`, `clearDefault`, `defaultClear`, `defaultBrick`, `brickDefault`, `brickClear`, `clearBrick`, `clearClear`. По умолчанию `default`.

<MdxTabs>

<AutoCompleteExampleForm />

```tsx
import React, { useState } from 'react';

import { AutoComplete } from '@consta/uikit/AutoComplete';

type Item = {
  label: string;
  id: number;
};

const items: Item[] = [
  {
    label: 'Первый',
    id: 1,
  },
  {
    label: 'Второй',
    id: 2,
  },
  {
    label: 'Третий',
    id: 3,
  },
];

const AutoCompleteExampleForm = () => {
  const [value, setValue] = useState<string | null>(null);
  return (
      <AutoComplete
        type="text"
        placeholder="Форма round"
        form="round"
        value={value}
        items={items}
       onChange={setValue}
      />
      <AutoComplete
        type="text"
        placeholder="Форма defaultBrick"
        form="defaultBrick"
        value={value}
        items={items}
       onChange={setValue}
      />
  );
};
```

</MdxTabs>

### Форма списка

Задает форму выпадающего списка через свойство `dropdownForm`. Варианты: `default`, `brick`, `round`. По умолчанию `default`.

<MdxTabs>

<AutoCompleteExampleDropdownForm />

```tsx
<AutoComplete
  type="text"
  placeholder="Форма списка round"
  dropdownForm="round"
  value={value}
  items={items}
 onChange={setValue}
/>
<AutoComplete
  type="text"
  placeholder="Форма списка brick"
  dropdownForm="brick"
  value={value}
  items={items}
 onChange={setValue}
/>
```

</MdxTabs>

### Вид

Определяет стиль поля через свойство `view`. Варианты: `default` (стандартный вид) и `clear` (минималистичный, для кастомизации). По умолчанию `default`.

<MdxTabs>

<AutoCompleteExampleView />

```tsx
import React, { useState } from 'react';

import { AutoComplete } from '@consta/uikit/AutoComplete';

type Item = {
  label: string;
  id: number;
};

const items: Item[] = [
  {
    label: 'Первый',
    id: 1,
  },
  {
    label: 'Второй',
    id: 2,
  },
  {
    label: 'Третий',
    id: 3,
  },
];
const AutoCompleteExampleView = () => {
  const [value, setValue] = useState<string | null>(null);
  return (
      <AutoComplete
        type="text"
        value={value}
        view="default"
        items={items}
       onChange={setValue}
      />
      <AutoComplete
        type="text"
        value={value}
        items={items}
        view="clear"
       onChange={setValue}
      />
  );
};
```

</MdxTabs>

## Поведение

### Виртуализация списка

Включает виртуализацию прокрутки через свойство `virtualScroll`. Оптимизирует производительность при работе с большими списками подсказок.

<MdxTabs>

<AutoCompleteExampleVirtualScroll />

```tsx
import { Example } from '@consta/stand';
import React, { useState } from 'react';

import { AutoComplete } from '../../..';

type Item = {
  label: string;
  id: number;
  groupId: number;
};

type Group = {
  label: string;
  id: number;
};

const items: Item[] = new Array(100000).fill(null).map((_, i) => ({
  label: `Опция ${i + 1}`,
  groupId: Math.floor(i / 100) + 1,
  id: i,
}));

const groups: Group[] = new Array(items.length / 100)
  .fill(null)
  .map((_, i) => ({
    id: i + 1,
    label: `Группа ${i + 1}`,
  }));

export const AutoCompleteExampleVirtualScroll = () => {
  const [value, setValue] = useState<string | null>(null);
  return (
    <AutoComplete
      placeholder="Чтобы посмотреть весь список, прокрутите вниз"
      items={items}
      value={value}
      onChange={setValue}
      groups={groups}
      virtualScroll
      searchFunction={(item, searchValue) => {
        if (!searchValue) {
          return true;
        }
        return (
          item.label
            .toLocaleLowerCase()
            .indexOf(searchValue.toLocaleLowerCase()) !== -1
        );
      }}
    />
  );
};
```

</MdxTabs>

### Индикация загрузки

Отображает индикатор загрузки через свойство `isLoading`. Используется для асинхронной подгрузки данных, например, при раскрытии списка или прокрутке.

<MdxTabs>

<AutoCompleteExampleIsLoading />

```tsx
type Item = {
  label: string;
  id: number;
};

const useMockLoadData = (
  searchValue = '',
  timeout = 2000,
): [Item[], boolean, () => void] => {
  const [isLoading, setIsLoading] = useFlag();
  const [isStart, setIsStart] = useFlag();
  const [length, setLength] = useState<number>(0);
  const isLoadingOffDebounce = useDebounce(setIsLoading.off, 2000);

  const items = useMemo(() => {
    if (searchValue) {
      return new Array(10000)
        .fill(null)
        .map((_, i) => ({
          label: `Опция ${i + 1}`,
          id: i,
        }))
        .filter(
          (item) =>
            item.label
              .toLocaleLowerCase()
              .indexOf(searchValue.toLocaleLowerCase()) !== -1,
        );
    }
    return new Array(length).fill(null).map((_, i) => ({
      label: `Опция ${i + 1}`,
      id: i,
    }));
  }, [length, searchValue]);

  useEffect(() => {
    if (isLoading) {
      setIsLoading.on();
      isLoadingOffDebounce();
    }
  }, [searchValue]);

  useEffect(() => {
    if (isStart) {
      setIsLoading.on();
    }

    const timeoutNumber = setTimeout(() => {
      if (isStart) {
        setLength((state) => state + 100);
        setIsLoading.off();
        setIsStart.off();
      }
    }, timeout);

    return () => {
      clearTimeout(timeoutNumber);
    };
  }, [isStart]);

  useEffect(() => {
    return () => {
      setIsLoading.off();
      setIsStart.off();
    };
  }, []);

  return [searchValue && isLoading ? [] : items, isLoading, setIsStart.on];
};

export const AutoCompleteExampleIsLoading = () => {
  const [value, setValue] = useState<string | null>();
  const [data, isLoading, onFocus] = useMockLoadData();

  return (
    <AutoComplete
      placeholder="Кликните по полю ввода, чтобы данные загрузились"
      items={data}
      value={value}
      onChange={setValue}
      onFocus={onFocus}
      isLoading={isLoading}
      virtualScroll
      searchFunction={(item, searchValue) => {
        if (!searchValue) {
          return true;
        }
        return (
          item.label
            .toLocaleLowerCase()
            .indexOf(searchValue.toLocaleLowerCase()) !== -1
        );
      }}
    />
  );
};
```

</MdxTabs>

### Неактивное поле

Делает поле неактивным через свойство `disabled`. Блокирует взаимодействие с полем и выпадающим списком.

<MdxTabs>

<AutoCompleteExampleDisabled />

```tsx
import React, { useState } from 'react';

import { AutoComplete } from '@consta/uikit/AutoComplete';

type Item = {
  label: string;
  id: number;
};

const items: Item[] = [
  {
    label: 'Первый',
    id: 1,
  },
  {
    label: 'Второй',
    id: 2,
  },
  {
    label: 'Третий',
    id: 3,
  },
];

const AutoCompleteExampleDisabled = () => {
  const [value, setValue] = useState<string | null>(null);
  return (
    <AutoComplete
      type="text"
      placeholder="Пример disabled"
      form="round"
      disabled
      value={value}
      items={items}
      onChange={setValue}
    />
  );
};
```

</MdxTabs>

### Состояние списка

Управляет состоянием выпадающего списка через свойства `dropdownOpen` (открыт/закрыт), `onDropdownOpen` (обработчик открытия/закрытия) и `ignoreOutsideClicksRefs` (игнорирование кликов по указанным элементам).

<MdxTabs>

<AutoCompleteExampleDropdownOpen />

```tsx
type Item = {
  label: string;
  id: number | string;
};

const items: Item[] = [
  {
    label: 'Первый',
    id: 1,
  },
  {
    label: 'Второй',
    id: 2,
  },
  {
    label: 'Третий',
    id: 3,
  },
];

const Icon = withAnimateSwitcherHOC({
  startIcon: IconArrowDown,
  startDirection: 0,
  endDirection: 180,
});

export const AutoCompleteExampleDropdownOpen = () => {
  const [value, setValue] = useState<string | null>();
  const [open, setOpen] = useFlag();
  const buttonRef = useRef<HTMLButtonElement>(null);
  const inputRef = useRef<HTMLInputElement>(null);
  const onDropdownOpen = useCallback((open: boolean) => {
    setOpen.set(open);
    if (open) {
      inputRef.current?.focus();
    }
  }, []);

  return (
    <Example col={1}>
      <AnimateIconSwitcherProvider active={open}>
        <FieldGroup>
          <Button
            ref={buttonRef}
            label={open ? 'Закрыть' : 'Открыть'}
            onClick={setOpen.toggle}
            iconLeft={Icon}
            onlyIcon
          />
          <AutoComplete
            inputRef={inputRef}
            placeholder="Выберите вариант"
            items={items}
            value={value}
            onChange={setValue}
            dropdownOpen={open}
            onDropdownOpen={onDropdownOpen}
            ignoreOutsideClicksRefs={[buttonRef]}
            searchFunction={(item, searchValue) => {
              if (!searchValue) {
                return true;
              }
              return (
                item.label
                  .toLocaleLowerCase()
                  .indexOf(searchValue.toLocaleLowerCase()) !== -1
              );
            }}
          />
        </FieldGroup>
      </AnimateIconSwitcherProvider>
    </Example>
  );
};
```

</MdxTabs>

## Кастомный элемент списка

Позволяет настроить отображение элементов списка через свойство `renderItem`. Принимает функцию рендера, которая определяет, как будет выглядеть каждый элемент.

<MdxTabs>

<AutoCompleteExampleRenderItem />

```tsx
import './AutoCompleteExampleRenderItem.css';

import React, { useState } from 'react';

import { AutoComplete } from '@consta/uikit/AutoComplete';
import { IconEdit } from '@consta/uikit/IconEdit';

type Item = {
  label: string;
  id: number;
};

const items: Item[] = [
  {
    label: 'Первый',
    id: 1,
  },
  {
    label: 'Второй',
    id: 2,
  },
  {
    label: 'Третий',
    id: 3,
  },
];

const AutoCompleteExampleRenderItem = () => {
  const [value, setValue] = useState<string | null>(null);
  return (
    <AutoComplete
      type="text"
      value={value}
      items={items}
      renderItem={({ item, active, hovered, onClick, onMouseEnter, ref }) => (
        <div
          aria-selected={active}
          aria-hidden="true"
          onMouseEnter={onMouseEnter}
          onClick={onClick}
          ref={ref}
        >
          <IconEdit />
          {item.label}
        </div>
      )}
      onChange={setValue}
    />
  );
};
```

</MdxTabs>

## Пример использования

Пример демонстрирует использование `AutoComplete` для автодополнения адресов электронной почты с динамической генерацией подсказок.

<MdxTabs>

<AutoCompleteExampleTypeEmail />

```tsx
import React, { useState } from 'react';

import { AutoComplete } from '@consta/uikit/AutoComplete';

const getMailItems = (value: string | null | undefined): Item[] => {
  const postfixes = ['@gmail.com', '@yandex.com', '@mail.ru'];
  if (postfixes.find((el) => value?.includes(el))) {
    return [];
  }
  return postfixes.map((el, index) => ({
    id: index,
    label: `${value}${el}`,
  }));
};

const AutoCompleteExampleTypeEmail = () => {
  const [value, setValue] = useState<string | null>(null);
  return (
    <AutoComplete
      type="email"
      value={value}
      items={getMailItems(value)}
      onChange={setValue}
    />
  );
};
```

</MdxTabs>
