import { MdxMenu, MdxTabs } from '@consta/stand';
import {
  ThemeTogglerExampleQuantityTwo,
  ThemeTogglerExampleQuantityThree,
} from './examples/ThemeTogglerExampleQuantity/ThemeTogglerExampleQuantity';

import { ThemeTogglerExampleSize } from './examples/ThemeTogglerExampleSize/ThemeTogglerExampleSize';
import { ThemeTogglerExampleGetters } from './examples/ThemeTogglerExampleGetters/ThemeTogglerExampleGetters';
import { ThemeTogglerExampleDefault } from './examples/ThemeTogglerExampleDefault/ThemeTogglerExampleDefault';

<MdxMenu>

- [Обзор](#обзор)
- [Импорт](#импорт)
- [Свойства](#свойства)
- [Содержимое](#содержимое)
  - [Иконка и название темы](#иконка-и-название-темы)
  - [Контекстное меню](#контекстное-меню)
- [Внешний вид](#внешний-вид)
  - [Размер](#размер)
  - [Стиль](#стиль)
- [Пример использования](#пример-использования)

</MdxMenu>

## Обзор

Компонент `ThemeToggler` предназначен для переключения тем оформления интерфейса. Он позволяет пользователю выбрать одну из доступных тем, каждая из которых может иметь уникальную иконку, название и идентификатор. Компонент поддерживает как переключение между двумя темами по клику на иконку, так и выбор из большего числа тем через контекстное меню.

## Импорт

```tsx
import { ThemeToggler } from '@consta/uikit/ThemeToggler';
```

## Свойства

```tsx
export const themeTogglerPropSize = ['m', 'l', 's', 'xs'] as const;
export type ThemeTogglerPropSize = typeof themeTogglerPropSize[number];
export const themeTogglerPropSizeDefault: ThemeTogglerPropSize =
  themeTogglerPropSize[0];

export type ThemeTogglerPropOnChange<ITEM> = (
  value: ITEM,
  props: {
    e: React.MouseEvent;
  },
) => void;
export type ThemeTogglerPropGetItemKey<ITEM> = (item: ITEM) => string | number;
export type ThemeTogglerPropGetItemLabel<ITEM> = (item: ITEM) => string;
export type ThemeTogglerPropGetItemIcon<ITEM> = (item: ITEM) => IconComponent;

export type ThemeTogglerItemDefault = {
  key: string;
  label: string;
  icon: IconComponent;
};
```

| Свойство                                   | Тип и значения                                   | По умолчанию   | Описание                                                                                                                        |
| ------------------------------------------ | ------------------------------------------------ | -------------- | ------------------------------------------------------------------------------------------------------------------------------- |
| [`items`](#содержимое)                     | `ITEM[]`                                         | -              | Массив тем для выбора                                                                                                           |
| [`value`](#содержимое)                     | `ITEM`                                           | -              | Текущая выбранная тема                                                                                                          |
| [`getItemKey?`](#иконка-и-название-темы)   | `ThemeTogglerPropGetItemKey`                     | `getItemLabel` | Функция для получения ключа, уникального для каждой темы                                                                        |
| [`getItemLabel?`](#иконка-и-название-темы) | `ThemeTogglerPropGetItemLabel`                   | -              | Функция для получения названия темы                                                                                             |
| [`getItemIcon?`](#иконка-и-название-темы)  | `ThemeTogglerPropGetItemIcon`                    | -              | Функция для получения иконки темы                                                                                               |
| [`size?`](#размер)                         | `'xs' \| 's' \| 'm' \| 'l'`                      | `'m'`          | Размер переключателя и контекстного меню                                                                                        |
| [`view?`](#стиль)                          | `'clear' \| 'primary' \| 'secondary' \| 'ghost'` | `'clear'`      | Внешний вид переключателя, см. [Button](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-button-stable/tab:dev/hash:внешний-вид) |
| [`direction?`](#направление)               | `Direction`                                      | -              | Направление разворачивания контекстного меню (для трёх и более тем)                                                             |
| [`possibleDirections?`](#направление)      | `Direction[]`                                    | -              | Список возможных направлений разворачивания контекстного меню (для трёх и более тем)                                            |
| `onChange?`                                | `ThemeTogglerPropOnChange`                       | -              | Функция, вызываемая при изменении выбранной темы                                                                                |
| `className?`                               | `string`                                         | -              | Дополнительный CSS-класс для контейнера (если тем две) или кнопки (если тем больше двух)                                        |
| `as?`                                      | `React.ElementType`                              | -              | HTML-тег или компонент для рендеринга                                                                                           |
| `ref?`                                     | `React.Ref`                                      | -              | Ссылка на DOM-элемент или компонент                                                                                             |

## Содержимое

Компонент `ThemeToggler` работает с массивом тем, переданных через свойство `items`. Каждая тема в массиве может быть представлена объектом с атрибутами:

- `key` — уникальный идентификатор темы (тип: `string | number`).
- `label` — название темы, отображаемое в контекстном меню (тип: `string`).
- `icon` — иконка темы, отображаемая в переключателе (тип: `IconComponent`).

Текущая выбранная тема определяется свойством `value`.

### Иконка и название темы

Для получения данных о теме используются функции:

- `getItemKey` — возвращает уникальный идентификатор темы. Если не указана, используется значение из `getItemLabel`.
- `getItemLabel` — возвращает название темы, отображаемое в контекстном меню.
- `getItemIcon` — возвращает иконку темы, отображаемую в переключателе.

Пример использования функций для кастомизации тем:

<MdxTabs>

<ThemeTogglerExampleGetters />

```tsx
type Item = 'Default' | 'Dark' | 'Display';

const items: Item[] = ['Default', 'Dark', 'Display'];

const getItemIcon = (item: Item) => {
  if (item === 'Default') {
    return IconSun;
  }
  if (item === 'Dark') {
    return IconMoon;
  }
  return IconLightningBolt;
};

const getTheme = (item: Item) => {
  if (item === 'Default') {
    return presetGpnDefault;
  }
  if (item === 'Dark') {
    return presetGpnDark;
  }
  return presetGpnDisplay;
};

export const ThemeTogglerExampleGetters = () => {
  const [value, setValue] = useState<Item>(items[0]);

  return (
    <Theme preset={getTheme(value)}>
      <ThemeToggler
        items={items}
        value={value}
        getItemKey={(item) => item}
        getItemLabel={(item) => item}
        getItemIcon={getItemIcon}
        onChange={setValue}
        direction="downStartLeft"
      />
    </Theme>
  );
};
```

</MdxTabs>

Если в `items` указано только две темы, переключение происходит сразу по клику на иконку:

<ThemeTogglerExampleQuantityTwo />

### Контекстное меню

Если тем в массиве `items` больше двух, при клике на иконку открывается контекстное меню, в котором можно выбрать тему. Контекстное меню построено на основе компонента [Popover](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-popover-stable/tab:dev).

#### Направление

Направление разворачивания контекстного меню задаётся свойствами:

- `direction` — определяет, в каком направлении раскрывается меню.
- `possibleDirections` — задаёт список допустимых направлений для раскрытия.

Подробности см. в документации [Popover](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-popover-stable/tab:dev/hash:направление-разворачивания).

Пример с тремя темами и контекстным меню:

<ThemeTogglerExampleQuantityThree />

## Внешний вид

### Размер

Свойство `size` позволяет изменять размер компонента и контекстного меню. Доступные значения: `'xs'`, `'s'`, `'m'`, `'l'`. По умолчанию используется `'m'`.

<ThemeTogglerExampleSize />

### Стиль

Свойство `view` определяет внешний вид переключателя. Доступные значения: `'clear'`, `'primary'`, `'secondary'`, `'ghost'`. По умолчанию используется `'clear'`.

Подробности о стилях см. в документации [Button](##LIBS.LIB.STAND.TAB/lib:uikit/stand:components-button-stable/tab:dev/hash:внешний-вид).

## Пример использования

Пример базового использования компонента `ThemeToggler` с тремя темами:

<MdxTabs>

<ThemeTogglerExampleDefault />

```tsx
import React, { useState } from 'react';
import { ThemeToggler } from '@consta/uikit/ThemeToggler';
import { IconSun } from '@consta/uikit/IconSun';
import { IconMoon } from '@consta/uikit/IconMoon';

export type ThemeType = {
  label: string;
  theme: ThemePreset;
  icon: IconComponent;
};

export const items: ThemeType[] = [
  {
    theme: presetGpnDefault,
    label: 'Default',
    icon: IconSun,
  },
  {
    theme: presetGpnDark,
    label: 'Dark',
    icon: IconMoon,
  },
  {
    theme: presetGpnDisplay,
    label: 'Display',
    icon: IconLightningBolt,
  },
];

const Example = () => {
  const [value, setValue] = useState<ThemeType>(items[0]);

  return (
    <Theme preset={value.theme} className={cnDocsDecorator('Section')}>
      <ThemeToggler
        items={items}
        value={value}
        onChange={setValue}
        direction="downStartLeft"
      />
    </Theme>
  );
};
```

</MdxTabs>
