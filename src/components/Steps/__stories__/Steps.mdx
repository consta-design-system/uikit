# Steps

Этот компонент позволяет показывать контент пользователю в нужной последовательности — во вкладках.
И, если нужно, показать, какие шаги он прошел, какие пропустил и сколько осталось.

Это удобно, если пользователю нужно заполнить длинную форму, например, пройти тестирование.




- [Шаги](#шаги)
  - [Активный шаг](#активный-шаг)
  - [Недоступные шаги](#пройденные-шаги)
  - [Пройденные шаги](#пройденные-шаги)
  - [Пропущенные шаги](#пропущенные-шаги)
- [Содержимое](#содержимое)
- [Размер](#размер)
- [Список свойств](#свойства)
- [Пример использования](#пример)

## Шаги

Данные для отображения шагов можно задать в массиве `items`. Названия шагов можно получить с помощью функции `getLabel`.

> 5 шагов — это максимум, больше делать не стоит.

### Активный шаг

Это шаг, в котором находится пользователь, за него отвечает свойство `value`

<нужен пример с активным шагом>

### Недоступные шаги

Это шаги, которые пока нельзя пройти. Например, они откроются, когда пользователь пройдет предыдущий шаг.

Такие шаги выделены цветом. Их можно получить с помощью функции `getDisabled`.

<нужен пример с недоступным шагом>


### Пройденные шаги

Пройденные шаги — те, к которым пользователю не нужно возвращаться. Например,
те, в которых он ответил на все вопросы или заполнил все обязательные поля в форме.

Такие шаги выделены цветом и иконкой `IconCheck`. Их можно получить с помощью функции `getCompleted`.

<нужен пример с пройденным шагом>


### Пропущенные шаги

Пропущенные шаги — те, на которых пользователь побывал, но что-то не доделал: например,
не ответил на вопросы или не заполнил поля.

Такие шаги выделены цветом. Их можно получить с помощью функции `getSkipped`.

<нужен пример с пропущенным шагом>

## Содержимое

Внутрь шага (то есть в соответствующую вкладку) можно поместить что угодно: формы, кнопки, текст.
Можно добавить дополнительные кнопки для переключения между шагами — например, **Вперед** и **Назад**.
По умолчанию таких кнопок в шагах нет.

<нужен пример шагов с контентом>

## Размер

За размер отвечает свойство `size`.

```tsx
<Steps size="m" />
<Steps size="l" />
```


## Свойства

```
type OnChange = (props: { e: React.MouseEvent; value: ITEM | null }) => void;
```

<!-- props:start -->

| Свойство                     | Тип                        | По умолчанию | Описание                                                                                    |
| ---------------------------- | -------------------------- | ------------ | ------------------------------------------------------------------------------------------- |
| [`value`](#активный-шаг)                      | `Item`                     | —            | Номер шага                                                                                    |
| [`items`](#шаги)                       | `Item[]`                   | —            | Массив с шагами                                                                             |
| [`getLabel`](#шаги)                    | `(item: Item) => string`   | —            | Получает название для шага. Также используется в качестве уникального ключа элемента |
| [`getDisabled?`](#недоступные-шаги)                | `(item: Item) => boolean`  | —            | Получает недоступные шаги                                             |
| [`getCompleted?`](#пройденные-шаги)               | `(item: Item) => boolean`  | —            | Получает завершенные шаги                                               |
| [`getSkipped?`](#пропущенные-шаги)                 | `(item: Item) => boolean`  | —            | Получает пропущенные шаги
| `onChange`                    | `OnChange`                 | —            | Меняет шаги
| [`size?`](#размер)           | `'m', 'l'`                 | `'m'`        | Размер элементов компонента                                                                   |
| `className?`                 | `string`                   | —            | Дополнительные CSS-классы для компонента                                                                |

<!-- props:end -->

## Пример

```ts
// src/App.ts
import React from 'react';
import { Steps } from '@consta/uikit/Steps';
import { Text } from '@consta/uikit/Text';
import { BasicSelect } from '@consta/uikit/BasicSelect';
import { Button } from '@consta/uikit/Button';

const App = () => {
  type Item = {
    label: string;
  };

  const items: Item[] = [
    {
      label: 'Главное',
    },
    {
      label: 'Важное',
    },
    {
      label: 'Необязательное',
    },
  ];

  const getStepContent = (stepNumber: number) => {
    switch (stepNumber) {
      case 0:
        return (
          <>
            <Text view='primary'>Содержимое первого шага</Text>
            <BasicSelect className={cnStepsStories('Select')} id='select' placeholder='Список' options={['1', 'вторая опция', '3', 'e']} getOptionLabel={o => o} />
          </>
        );
      case 1:
        return (
          <>
            <Text view='primary'>Содержимое второго шага</Text>
          </>
        );
      case 2:
        return <Text view='brand'>Содержимое шага № 3</Text>;
      default:
        return `unknown ${stepNumber} step`;
    }
  };

  const [activeStep, setActiveStep] = React.useState<number>(0);
  const [skippedSteps, setSkippedSteps] = React.useState<Set<number>>(new Set());
  const [completedSteps, setCompletedSteps] = React.useState<Set<number>>(new Set());

  const getStepIndex = (step: Item | null): number => items.findIndex((item) => step && item.label === step.label);

  const getSkipped = (step: Item): boolean => skippedSteps.has(getStepIndex(step));
  const getCompleted = (step: Item): boolean => completedSteps.has(getStepIndex(step));
  const getDisabled = (step: Item): boolean =>
    getStepIndex(step) >= 2 && skippedSteps.size === 0 && completedSteps.size === 0;
  const handleNext = () => {
    if (activeStep < items.length - 1) {
      const newCompleted = new Set(completedSteps);
      newCompleted.add(activeStep);
      setCompletedSteps(newCompleted);
      setActiveStep((prevActiveStep) => prevActiveStep + 1);
    }
  };
  const handlePrev = () => {
    if (activeStep > 0) {
      if (completedSteps.has(activeStep)) {
        setActiveStep((prevActiveStep) => prevActiveStep - 1);
      } else {
        const newSkipped = new Set(skippedSteps);
        newSkipped.add(activeStep);
        setSkippedSteps(newSkipped);
        setActiveStep((prevActiveStep) => prevActiveStep - 1);
      }
    }
  };
  const handleReset = () => {
    setSkippedSteps(new Set());
    setCompletedSteps(new Set());
    setActiveStep(0);
  };
  const handleChange = ({ value }: { value: Item | null }) => {
    if (completedSteps.has(activeStep)) {
      setActiveStep(getStepIndex(value));
    } else {
      const newSkipped = new Set(skippedSteps);
      newSkipped.add(activeStep);
      setSkippedSteps(newSkipped);
      setActiveStep(getStepIndex(value));
    }
  };

  const handleSkip = () => {
    const newSkipped = new Set(skippedSteps);
    newSkipped.add(activeStep);
    setSkippedSteps(newSkipped);
    setActiveStep((prevActiveStep) => prevActiveStep + 1);
  };

  return (
    <div className={cnStepsStories()}>
      <Steps
        items={items}
        getLabel={(item) => item.label}
        value={items[activeStep]}
        onChange={handleChange}
        getCompleted={getCompleted}
        getSkipped={getSkipped}
        getDisabled={getDisabled}
      />
      <div className={cnStepsStories('Content')}>{getStepContent(activeStep)}</div>
      <div className={cnStepsStories('Actions')}>
        <Button onClick={handlePrev} label="Назад" iconLeft={IconBackward} view='ghost' disabled={activeStep === 0} />
        <div>
          {(skippedSteps.size > 0 || completedSteps.size > 0) && <Button className={cnStepsStories('ResetButton')} onClick={handleReset} label="Отменить" view='ghost' />}
          {activeStep === 1 ? <Button onClick={handleSkip} label="Заполнить позже" /> : <Button onClick={handleNext} label="Дальше" iconRight={IconForward} />}
        </div>
      </div>
    </div>
  );
};
```
